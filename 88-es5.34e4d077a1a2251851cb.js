!function(){function e(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||t(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if(e){if("string"==typeof e)return o(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,i=new Array(t);o<t;o++)i[o]=e[o];return i}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(n=i.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var i=o.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"))?r:String(r)),i)}var n,r}function r(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var o,i=u(e);if(t){var n=u(this).constructor;o=Reflect.construct(i,arguments,n)}else o=i.apply(this,arguments);return c(this,o)}}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(self.webpackChunkwil_admin_angular=self.webpackChunkwil_admin_angular||[]).push([[88],{2088:function(o,n,s){"use strict";s.r(n),s.d(n,{AccessManagementModule:function(){return pe}});var c=s(38583),u=s(3679),d=s(65461),p=s(977),f=s(66782),m=s(98542),h=s(24020),g=s(95987),b=s(99688),v={},y={},S=[{template:"<p>Vous pouvez ajouter des departements \xe0 votre organisation.</p>"},{fieldGroup:[{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-5 wl-hidden",key:"id",type:"input",templateOptions:{translate:!0,label:"ID",readonly:!0}},{className:"flex-5",key:"code",type:"input",templateOptions:{translate:!0,label:"Code",required:!0},expressionProperties:{"model.code":function(e,t,o){if(e.code)return e.code.toUpperCase().split(" ").join("_")}}},{className:"flex-5",key:"label",type:"input",templateOptions:{translate:!0,label:"Libelle",required:!0}},{className:"flex-5",key:"description",type:"input",templateOptions:{translate:!0,label:"Description"}},{className:"flex-1",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:function(e){console.log("clik on submit"),e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,o){return!o.form.valid}}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.options.resetModel(v)}}}]}]}],O=s(42394),T=s(91841),k=s(37716),x=s(44212),E=s(18859),A=s(52121),_=s(68058),P=s(4768),w=s(28723);function C(e,t){if(1&e){var o=k.EpF();k.TgZ(0,"wl-form",7),k.NdJ("onSubmit",function(e){return k.CHM(o),k.oxw().save(e)})("onModelChange",function(e){return k.CHM(o),k.oxw().modelChange(e)}),k.qZA()}if(2&e){var i=k.oxw();k.Q6J("alert",i.alert)("model",i.form.model)("fields",i.form.fields)("options",i.form.options)}}var D=s(23815),L=function(){var e=function(e){a(o,e);var t=l(o);function o(e,n,r,a,s,l,c,u){var d;i(this,o),(d=t.call(this,e,n,r,a,s,l,c)).logger=e,d.httpService=n,d.envService=r,d.messageService=a,d.authService=s,d.menuService=l,d.modal=c,d.changeDetectorRef=u,d.isEditMode=!1,d.isVisible=!1;var p=d.authService.hasPermissionAuthorizationV2(["USER_LIST.CREATE","USER_LIST.LOCK","USER_LIST.EDIT","USER_LIST.UNLOCK","USER_LIST.EXPORT","USER_LIST.DELETE","SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);return d.hasPermissionToLock=p[1],d.hasPermissionToEdit=p[2],d.hasPermissionToUnlock=p[3],d.hasPermissionToExport=p[4],d.hasPermissionToDelete=p[5],d.hasPermissionToShowAllEntityData=p[6],d.hasPermissionToShowDataRoot=p[7],d.hasPermissionToCreate=p[0],d}return r(o,[{key:"maFonction",value:function(){this.form.fields[0].template="<p>Veuillez remplir ce formulaire pour cr\xe9er une permission.</p>",this.isVisible=!0,this.isEditMode=!1}},{key:"modalTitle",get:function(){return this.isEditMode?"Mise \xe0 jour":"Ajouter"}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnInit",value:function(){var e=this;this.form.model=Object.assign({},v),this.form.fields=S,this.form.options=y,this.globalFilterFields=["code","label"],this.columns=[{field:"code",header:"Code"},{field:"label",header:"Libelle"},{field:"description",header:"Description"},{field:"status",header:"STATUS",type:"status",falseText:"Non",trueText:"Oui"},{field:"created_at",header:"CREATED_AT",type:"date"}],this.user&&this.hasPermissionToEdit&&this.actions.push({type:"default",icon:"edit",shape:"circle",loading:!1,click:function(t){e.edit(t),e.logger.log(t),e.isEditMode=!0,e.isVisible=!0,e.form.fields[0].template="<p>Veuillez renseigner ce formulaire pour modifier les informations de la dite permission.</p>",setTimeout(function(){e.alert=void 0,t.status=0!=t.status,e.form.model=Object.assign({},t),e.form.fields[0].fieldGroup[0].template="<h5>Vous modifiez de l'utilisateur <i>".concat(t.login,"</i> </h5>"),e.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="Enregistrer",e.changeDetectorRef.detectChanges()},1)}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"warning",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:function(t){e.swingstatus(t)},cancel:function(e){}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:function(t){e.delete(t,"profiles")},cancel:function(e){}})}},{key:"save",value:function(e){var t=this;if(console.log(e),1==this.isEditMode){this.changeDetectorRef.detectChanges(),this.logger.log("event.model: ",e.model);var o=Object.assign(Object.assign({},e.model),{phone:e.model.prefix+" "+e.model.phone,session:this.user.session_id});this.logger.log("payload ",o);var i=o.id;o=D.omit(o,["id"]),o=Object.assign(Object.assign({},o),{updated_user:this.user.id}),this.putData("".concat(O.T5,"/profiles/").concat(i),o,function(e){e instanceof T.UA||(t.loadData(t.currentLoadEvent),t.isVisible=!1)})}else{var n=Object.assign(Object.assign({},e.model),{code:e.model.code,libelle:e.model.libelle,session:this.user.session_id});console.log(n),this.logger.log("payload ",n),n.id&&null!=n.id?(n=Object.assign(Object.assign({},n),{added_user:this.user.id}),this.postData("".concat(O.T5,"/profiles"),n,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})):(console.log(n),n=D.omit(n,["id"]),n=Object.assign(Object.assign({},n),{added_user:this.user.id}),this.postData("".concat(O.T5,"/profiles"),n,function(e){e instanceof T.UA||(t.loadData(t.currentLoadEvent),t.isVisible=!1)}))}}},{key:"swingstatus",value:function(e){var t=this,o=e.id,i=e.status;if(1==i){var n=D.omit(e,["id"]);n={status:!1,updated_user:this.user.id},this.putData("".concat(O.T5,"/profiles/").concat(o),n,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})}if(0==i){var r=D.omit(e,["id"]);r={status:!0,updated_user:this.user.id},this.putData("".concat(O.T5,"/profiles/").concat(o),r,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})}}},{key:"loadData",value:function(e){var t=this;this.loading=!0,this.currentLoadEvent=e,this.getData("".concat(this.hasPermissionToShowAllEntityData?"".concat(O.T5,"/profiles/"):"".concat(O.T5,"/profiles/byEntity/").concat(this.user.entity.id),"?page=").concat(e.first/e.rows+1,"&per_page=").concat(e.rows).concat(null!=e.globalFilter?'&search={"sKey":"all","sValue":"'.concat(e.globalFilter,'"}'):"").concat(e.sortField&&null!=e.sortField?'&sort=[{"sortField":"'.concat(e.sortField,'","sortOrder":"').concat(1==e.sortOrder?"ASC":"DESC",'"}]'):'&sort=[{"sortField":"id","sortOrder":"DESC"}]'),function(e){if(!(e instanceof T.UA)){var o=e.body.rows;t.user&&!t.user.is_root&&(o=o.filter(function(e){return!e.is_root})),t.hasPermissionToShowDataRoot||(o=o.filter(function(e){return!e.profiles.map(function(e){return e.code}).includes("PROF_ROOT")})),o=o.map(function(e){return Object.assign(Object.assign({},e),{trClass:e.status?"Actif":"Inactif"})}),t.data=o,t.loading=!1,t.changeDetectorRef.detectChanges()}})}},{key:"handleCancel",value:function(){this.isVisible=!1}}]),o}(b.K);return e.\u0275fac=function(t){return new(t||e)(k.Y36(x.Kf),k.Y36(E.O),k.Y36(A.L),k.Y36(_.dD),k.Y36(P.e),k.Y36(w.h),k.Y36(m.Sf),k.Y36(k.sBO))},e.\u0275cmp=k.Xpm({type:e,selectors:[["profile"]],features:[k.qOj],decls:11,vars:18,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[2,"width","100%","text-align","center"],[2,"border","3px dashed whitesmoke","padding","400px"],[2,"font-size","small"],[1,"button-19",2,"margin-left","20px",3,"click"],[3,"data","styleClass","showTools","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(k.TgZ(0,"nz-modal",0),k.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),k.YNc(1,C,1,4,"wl-form",1),k.qZA(),k._UZ(2,"br"),k.TgZ(3,"table",2),k.TgZ(4,"tr",3),k.TgZ(5,"td"),k.TgZ(6,"h5",4),k._uU(7," Ajouter un profil \xe0 votre organisation en cliquant sur ce bouton "),k.TgZ(8,"button",5),k.NdJ("click",function(){return t.maFonction()}),k._uU(9,"Ajouter"),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.TgZ(10,"wl-table",6),k.NdJ("onLazyLoad",function(e){return t.loadData(e)}),k.qZA()),2&e&&(k.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),k.xp6(10),k.Udp("margin-top","1rem"),k.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("showTools",t.hasPermissionToExport)("columns",t.columns)("showTools",!0)("actions",t.actions)("lazy",!0)("caption","Departements")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[m.du,m.Hf,p.a,d.U],styles:[".search-input .inline{display:inline-block;margin:0!important;padding:0!important}  .search-input .inline nz-input-group{border-radius:.2rem 0 0 .2rem!important}  .search-input .inline:last-child button{border-radius:0 0 10px 0}  .search-input .inline:last-child{position:relative;top:1.8rem;left:-1.5px;margin:0;padding:0}  .search-input .inline:last-child nz-input-group{border-radius:0 .2rem .2rem 0!important}  .button-19{background:#0d6d3a;border:1px solid #0d6d3a;border-radius:6px;box-shadow:1px 2px 4px rgba(0,0,0,.1);box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:nunito,roboto,proxima-nova,proxima nova,sans-serif;font-size:13px;font-weight:800;line-height:16px;min-height:40px;outline:0;padding:12px 14px;text-align:center;text-rendering:geometricprecision;text-transform:none;-moz-user-select:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle}  .button-19:active,   .button-19:hover{background-color:transparent;background-color:initial;background-position:0 0;color:#0d6d3a}"],changeDetection:0}),e}(),z={},R={},F=[{template:"<p>Vous pouvez ajouter des departements \xe0 votre organisation.</p>"},{fieldGroup:[{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-auto wl-hidden",key:"id",type:"input",templateOptions:{translate:!0,label:"ID",readonly:!0}},{className:"flex-5",key:"code",type:"input",templateOptions:{translate:!0,label:"Code",required:!0},expressionProperties:{"model.code":function(e,t,o){if(e.code)return e.code.toUpperCase().split(" ").join("_")}}},{className:"flex-5",key:"label",type:"input",templateOptions:{translate:!0,label:"Libelle",required:!0}},{className:"flex-auto",key:"description",type:"input",templateOptions:{translate:!0,label:"Description"}},{className:"flex-1",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:function(e){console.log("clik on submit"),e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,o){return!o.form.valid}}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.options.resetModel(z)}}}]}]}],j=s(33013);function V(e,t){if(1&e){var o=k.EpF();k.TgZ(0,"wl-form",7),k.NdJ("onSubmit",function(e){return k.CHM(o),k.oxw().save(e)})("onModelChange",function(e){return k.CHM(o),k.oxw().modelChange(e)}),k.qZA()}if(2&e){var i=k.oxw();k.Q6J("alert",i.alert)("model",i.form.model)("fields",i.form.fields)("options",i.form.options)}}var N,M=s(23815),U=function(){var e=function(e){a(o,e);var t=l(o);function o(e,n,r,a,s,l,c,u){var d;i(this,o),(d=t.call(this,e,n,r,a,s,l,c)).logger=e,d.httpService=n,d.envService=r,d.messageService=a,d.authService=s,d.menuService=l,d.modal=c,d.changeDetectorRef=u,d.isEditMode=!1,d.isVisible=!1;var p=d.authService.hasPermissionAuthorizationV2(["USER_LIST.CREATE","USER_LIST.LOCK","USER_LIST.EDIT","USER_LIST.UNLOCK","USER_LIST.EXPORT","USER_LIST.DELETE","SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);return d.hasPermissionToLock=p[1],d.hasPermissionToEdit=p[2],d.hasPermissionToUnlock=p[3],d.hasPermissionToExport=p[4],d.hasPermissionToDelete=p[5],d.hasPermissionToShowAllEntityData=p[6],d.hasPermissionToShowDataRoot=p[7],d.hasPermissionToCreate=p[0],d}return r(o,[{key:"maFonction",value:function(){this.form.fields[0].template="<p>Veuillez remplir ce formulaire pour cr\xe9er une permission.</p>",this.isVisible=!0,this.isEditMode=!1}},{key:"modalTitle",get:function(){return this.isEditMode?"Mise \xe0 jour":"Ajouter"}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnInit",value:function(){var e=this;this.form.model=Object.assign({},z),this.form.fields=F,this.form.options=R,this.globalFilterFields=["code","libelle","status"],this.columns=[{field:"code",header:"Code"},{field:"label",header:"Libelle"},{field:"status",header:"STATUS",type:"status",falseText:"Inactif",trueText:"Actif"},{field:"created_at",header:"CREATED_AT",type:"date"}],this.user&&this.hasPermissionToEdit&&this.actions.push({type:"default",icon:"edit",shape:"circle",loading:!1,click:function(t){e.edit(t),e.logger.log(t),e.isEditMode=!0,e.isVisible=!0,e.form.fields[0].template="<p>Veuillez renseigner ce formulaire pour modifier les informations de la dite permission.</p>",setTimeout(function(){e.alert=void 0,t.status=0!=t.status,e.form.model=Object.assign({},t),e.form.fields[0].fieldGroup[0].template="<h5>Vous modifiez de l'utilisateur <i>".concat(t.login,"</i> </h5>"),e.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="Enregistrer",e.changeDetectorRef.detectChanges()},1)}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"warning",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:function(t){e.swingstatus(t)},cancel:function(e){}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:function(t){e.delete(t,"permissions")},cancel:function(e){}})}},{key:"save",value:function(e){var t=this;if(console.log(e),1==this.isEditMode){this.changeDetectorRef.detectChanges(),this.logger.log("event.model: ",e.model);var o=Object.assign(Object.assign({},e.model),{phone:e.model.prefix+" "+e.model.phone,session:this.user.session_id});this.logger.log("payload ",o);var i=o.id;o=M.omit(o,["id"]),o=Object.assign(Object.assign({},o),{updated_user:this.user.id}),this.putData("".concat(O.T5,"/permissions/").concat(i),o,function(e){e instanceof T.UA||(t.loadData(t.currentLoadEvent),t.isVisible=!1)})}else{var n=Object.assign(Object.assign({},e.model),{code:e.model.code,libelle:e.model.libelle,session:this.user.session_id});console.log(n),this.logger.log("payload ",n),n.id&&null!=n.id?(n=Object.assign(Object.assign({},n),{added_user:this.user.id}),this.postData("".concat(O.T5,"/permissions"),n,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})):(console.log(n),n=M.omit(n,["id"]),n=Object.assign(Object.assign({},n),{added_user:this.user.id}),this.postData("".concat(O.T5,"/permissions"),n,function(e){e instanceof T.UA||(t.loadData(t.currentLoadEvent),t.isVisible=!1)}))}}},{key:"swingstatus",value:function(e){var t=this,o=e.id,i=e.status;if(1==i){var n=M.omit(e,["id"]);n={status:!1,updated_user:this.user.id},this.putData("".concat(O.T5,"/permissions/").concat(o),n,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})}if(0==i){var r=M.omit(e,["id"]);r={status:!0,updated_user:this.user.id},this.putData("".concat(O.T5,"/permissions/").concat(o),r,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})}}},{key:"loadData",value:function(e){var t=this;this.loading=!0,this.currentLoadEvent=e,this.getData("".concat(O.T5,"/permissions/?page=").concat(e.first/e.rows+1,"&per_page=").concat(e.rows).concat(null!=e.globalFilter?'&search={"sKey":"all","sValue":"'.concat(e.globalFilter,'"}'):"").concat(e.sortField&&null!=e.sortField?'&sort=[{"sortField":"'.concat(e.sortField,'","sortOrder":"').concat(1==e.sortOrder?"ASC":"DESC",'"}]'):'&sort=[{"sortField":"id","sortOrder":"DESC"}]'),function(e){if(!(e instanceof T.UA)){var o=e.body.rows;t.user&&!t.user.is_root&&(o=o.filter(function(e){return!e.is_root})),t.hasPermissionToShowDataRoot||(o=o.filter(function(e){return!e.profiles.map(function(e){return e.code}).includes("PROF_ROOT")})),o=o.map(function(e){return Object.assign(Object.assign({},e),{trClass:e.status?"Actif":"Inactif"})}),t.data=o,t.loading=!1,t.changeDetectorRef.detectChanges()}})}},{key:"handleCancel",value:function(){this.isVisible=!1}}]),o}(b.K);return e.\u0275fac=function(t){return new(t||e)(k.Y36(x.Kf),k.Y36(E.O),k.Y36(A.L),k.Y36(_.dD),k.Y36(P.e),k.Y36(w.h),k.Y36(m.Sf),k.Y36(k.sBO))},e.\u0275cmp=k.Xpm({type:e,selectors:[["permission"]],features:[k._Bn([j.ez]),k.qOj],decls:11,vars:18,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[2,"width","100%","text-align","center"],[2,"border","3px dashed whitesmoke","padding","400px"],[2,"font-size","small"],[1,"button-19",2,"margin-left","20px",3,"click"],[3,"data","styleClass","showTools","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(k.TgZ(0,"nz-modal",0),k.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),k.YNc(1,V,1,4,"wl-form",1),k.qZA(),k._UZ(2,"br"),k.TgZ(3,"table",2),k.TgZ(4,"tr",3),k.TgZ(5,"td"),k.TgZ(6,"h5",4),k._uU(7," Ajouter une permission \xe0 votre organisation en cliquant sur ce bouton "),k.TgZ(8,"button",5),k.NdJ("click",function(){return t.maFonction()}),k._uU(9,"Ajouter"),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.TgZ(10,"wl-table",6),k.NdJ("onLazyLoad",function(e){return t.loadData(e)}),k.qZA()),2&e&&(k.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),k.xp6(10),k.Udp("margin-top","1rem"),k.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("showTools",t.hasPermissionToExport)("columns",t.columns)("showTools",!0)("actions",t.actions)("lazy",!0)("caption","Departements")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[m.du,m.Hf,p.a,d.U],styles:[".search-input .inline{display:inline-block;margin:0!important;padding:0!important}  .search-input .inline nz-input-group{border-radius:.2rem 0 0 .2rem!important}  .search-input .inline:last-child button{border-radius:0 0 10px 0}  .search-input .inline:last-child{position:relative;top:1.8rem;left:-1.5px;margin:0;padding:0}  .search-input .inline:last-child nz-input-group{border-radius:0 .2rem .2rem 0!important}  .button-19{background:#0d6d3a;border:1px solid #0d6d3a;border-radius:6px;box-shadow:1px 2px 4px rgba(0,0,0,.1);box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:nunito,roboto,proxima-nova,proxima nova,sans-serif;font-size:13px;font-weight:800;line-height:16px;min-height:40px;outline:0;padding:12px 14px;text-align:center;text-rendering:geometricprecision;text-transform:none;-moz-user-select:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle}  .button-19:active,   .button-19:hover{background-color:transparent;background-color:initial;background-position:0 0;color:#0d6d3a}"],changeDetection:0}),e}(),I={},G={formState:{menuPermSelected:[],menusSelected:[],showCreateText:!0}},Z=[{fieldGroup:[{hide:!1,template:"<p>Vous pouvez attribuer des menus \xe0 un profil en suivant les \xe9tapes du formulaire.</p>",expressionProperties:{hide:function(e,t,o){return!G.formState.showCreateText}}},{hide:!0,template:"Vous n'avez pas de profil rattach\xe9 \xe0 votre entit\xe9. Veuillez cliquer sur le lien suivant pour <a href='".concat(O.b$,"/private/administration/profile'>cr\xe9er un profil</a>"),expressionProperties:{hide:function(e,t,o){return G.formState.showCreateText}}}]},{type:"stepper",templateOptions:{strictStepper:!0,nextText:"Suivant",previousText:"Pr\xe9c\xe9dent",doneText:"Soummettre",doneFn:function(e){e.model.action="SAVE",e.parent.templateOptions.doneLoading=!0,e.form.statusChanges.subscribe(function(t){e.parent.templateOptions.doneLoading&&(e.parent.templateOptions.doneLoading=!1)})}},fieldGroup:[{templateOptions:{label:"Select menu"},fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-5",key:"profile_id",type:"tree",templateOptions:{required:!0,translate:!0,multiple:!1,showExpand:!1,checkable:!1,label:"FORM_LABEL.PROFILE",options:[],dividerText:"Select_menus_to_add",divider:"right",onSelect:function(t,o){console.log("profil ==>",o);var i=o.node.origin;if(i.selected){var n=i.menus,r=n.map(function(e){return e.id}),a=t.parent.fieldGroup[1].templateOptions.options;G.formState.menusSelected=e(r),t.parent.fieldGroup[1].templateOptions.checkedKeys=G.formState.menusSelected;var s=O._.flatMapDepth(a,function e(t){var o;return(null===(o=t.children)||void 0===o?void 0:o.length)?O._.flatMapDepth(t.children,e):t}).concat(a);t.parent.fieldGroup[1].templateOptions.checkAll=s.every(function(e){return r.includes(e.key)}),t.form.markAllAsTouched(),G.formState.menuPermSelected=e(n.map(function(e){var t,o;return{value:null===(o=null===(t=e.ProfileMenu)||void 0===t?void 0:t.permission)||void 0===o?void 0:o.split(","),key:e.id}})),t.formControl.setValue(i),t.form.get("selected_menu").setValue(n.map(function(e){return Object.assign(Object.assign({},e),{title:e.label,key:e.id,isLeaf:!0})}))}else G.formState.menuPermSelected=[],G.formState.menusSelected=[],t.parent.fieldGroup[1].templateOptions.checkedKeys=[],t.parent.fieldGroup[1].templateOptions.checkAll=!1,t.formControl.setValue(null),t.form.get("selected_menu").setValue([])}}},{className:"flex-5",key:"menu_id",type:"tree",templateOptions:{checkable:!0,multiple:!0,translate:!0,label:"FORM_LABEL.MENU",options:[],onCheckAll:function(e,t,o){setTimeout(function(){console.log(o,t)},1e3);var i=t;function n(t){var i;if(o){var r=null===(i=t.permission)||void 0===i?void 0:i.map(function(e){return e.value});G.formState.menuPermSelected=q(G.formState.menuPermSelected,t.key,r)}else G.formState.menuPermSelected=G.formState.menuPermSelected.filter(function(e){return e.key!=t.key});t.children&&t.children.forEach(function(e){n(e)}),G.formState.menuPermSelected=O._.uniq(G.formState.menuPermSelected),G.formState.menusSelected=O._.uniq(G.formState.menuPermSelected.map(function(e){return e.key})),e.form.get("menuPermSelected").setValue(G.formState.menuPermSelected)}i.forEach(function(e){n(e.origin)}),e.form.get("selected_menu").setValue(i.map(function(e){return e.origin}))},onCheck:function(e,t){var o,i=t.node.origin,n=null===(o=t.node.parentNode)||void 0===o?void 0:o.origin,r=t.nodes.map(function(e){return e.origin});e.form.get("selected_menu").setValue(r),function t(o,i){var n;if(G.formState.menuPermSelected.find(function(e){return e.key==o.key}))G.formState.menuPermSelected=G.formState.menuPermSelected.filter(function(e){return e.key!=o.key}),i&&(G.formState.menuPermSelected=G.formState.menuPermSelected.filter(function(e){return e.key!=i.key}));else{var r=null===(n=o.permission)||void 0===n?void 0:n.map(function(e){return e.value});G.formState.menuPermSelected=q(G.formState.menuPermSelected,o.key,r)}o.children&&o.children.forEach(function(e){t(e)}),G.formState.menuPermSelected=O._.uniq(G.formState.menuPermSelected),G.formState.menusSelected=O._.uniq(G.formState.menuPermSelected.map(function(e){return e.key})),e.form.get("menuPermSelected").setValue(G.formState.menuPermSelected)}(i,n)}},hooks:{onInit:function(e){e.templateOptions.checkedKeys=G.formState.menusSelected}},expressionProperties:{}}]},{templateOptions:{label:"Acces to the menu"},fieldGroup:[{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-6",key:"selected_menu",type:"tree",templateOptions:{options:[],translate:!0,checkable:!1,label:"FORM_LABEL.SELECT_MENU",divider:"right",dividerText:"select_perm_to_add",onSelect:function(e,t){var o,i,n;N=null===(o=null==t?void 0:t.node)||void 0===o?void 0:o.origin,console.log(N);var r=(null===(i=G.formState.menuPermSelected.find(function(e){return e.key==N.key}))||void 0===i?void 0:i.value)||[],a=Array.isArray(null==N?void 0:N.permission)?N.permission:(null===(n=null==N?void 0:N.permission)||void 0===n?void 0:n.split(","))||[];a=null==a?void 0:a.map(function(e){return{key:e.value||e,title:e.label||e,isLeaf:!0}}),e.form.markAllAsTouched(),e.parent.fieldGroup[1].templateOptions.checkedKeys=r,e.form.get("access").setValue(a)}},hooks:{onInit:function(e){var t=e.formControl.value;console.log("node ==>",t),e.templateOptions.options=t,e.form.get("profile_id").value.menus.forEach(function(e){if(Y(t,e.id)){var o=e.ProfileMenu.permission.split(",")||[];G.formState.menuPermSelected=q(G.formState.menuPermSelected,e.id,o)}}),e.form.get("menuPermSelected").setValue(G.formState.menuPermSelected),console.log(G.formState.menuPermSelected)}}},{className:"flex-4",key:"access",type:"tree",templateOptions:{options:[],translate:!0,label:"FORM_LABEL.MENU_PERMISSIONS",onCheckAll:function(e,t){console.log(e,t);var o=e.templateOptions.checkedKeys;console.log(o),G.formState.menuPermSelected=q(G.formState.menuPermSelected,N.key,o),e.form.get("menuPermSelected").setValue(G.formState.menuPermSelected),console.log("menuPermSelected: ",G.formState.menuPermSelected)},onCheck:function(e,t){console.log(e,t),G.formState.menuPermSelected=q(G.formState.menuPermSelected,N.key,t.keys),e.form.get("menuPermSelected").setValue(G.formState.menuPermSelected),console.log("menuPermSelected: ",G.formState.menuPermSelected)}},hooks:{onInit:function(e){}}},{key:"menuPermSelected",type:"tree",templateOptions:{options:[],hidden:!0,required:!0}}]}]}]}];function q(e,t,o){if(null!=e){var i=Y(e,t);i?(e=e.filter(function(e){return e.key!=t}),i.value=o,e.push(i)):e.push({key:t,value:o})}else e.push({key:t,value:o});return e}function Y(e,o){var i,n,r=function(e,o){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=t(e))||o&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==i.return||i.return()}finally{if(l)throw a}}}}(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.key==o){i=a;break}if(a.children&&null!=a.children&&(i=Y(a.children,o)))break}}catch(s){r.e(s)}finally{r.f()}return i}var K=function(){var e=function(e){a(o,e);var t=l(o);function o(e,n,r,a,s,l){var c;i(this,o),(c=t.call(this,e,n,r,a,s,l)).logger=e,c.httpService=n,c.envService=r,c.messageService=a,c.authService=s,c.menuService=l;var u=c.authService.hasPermissionAuthorizationV2(["SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);return c.hasPermissionToShowAllEntityData=u[0],c.hasPermissionToShowDataRoot=u[1],c}return r(o,[{key:"ngOnInit",value:function(){this.form.fields=Z,this.form.model=I,this.form.options=G,this.loadAllProfil(),this.loadAllmenu(),this.form.options.formState.menuPermSelected=[],this.form.fields[1].fieldGroup[0].fieldGroup[0].templateOptions.selectedKeys=[],this.form.fields[1].fieldGroup[0].fieldGroup[1].templateOptions.checkedKeys=[],this.form.fields[1].fieldGroup[0].fieldGroup[1].templateOptions.checkAll=!1}},{key:"save",value:function(e){var t,o,i,n,r=this;this.logger.log("model: ",e.model);var a=(null===(t=e.model.menuPermSelected)||void 0===t?void 0:t.length)?null===(o=e.model.menuPermSelected)||void 0===o?void 0:o.map(function(t){var o,i,n;return{profile_id:null===(o=e.model.profile_id)||void 0===o?void 0:o.key,menu_id:t.key,permission:(null===(i=t.value)||void 0===i?void 0:i.join(","))||"foo",added_user:null===(n=r.user)||void 0===n?void 0:n.id,status:e.model.status}}):[{profile_id:null===(i=e.model.profile_id)||void 0===i?void 0:i.key,menu_id:void 0,permission:null,added_user:null===(n=this.user)||void 0===n?void 0:n.id,status:e.model.status}];this.logger.log("payload =>",a),"SAVE"==e.model.action&&this.httpService.postData("".concat(O.T5,"/profile-menus"),a).subscribe(function(e){r.form.model={},r.form.options.resetModel(),r.setMessage("success","Enregistrement effectu\xe9 avec succ\xe8s !"),r.form.fields=r.mapFields(Z,"submit","templateOptions.disabled",!0),r.form.options.formState.menuPermSelected=[],r.form.fields[1].fieldGroup[0].fieldGroup[0].templateOptions.selectedKeys=[],r.form.fields[1].fieldGroup[0].fieldGroup[1].templateOptions.checkedKeys=[],r.form.fields[1].fieldGroup[0].fieldGroup[1].templateOptions.checkAll=!1,r.loadAllProfil(),r.loadAllmenu()},function(e){r.logger.log("postData error ===> ",e),r.setBackendError(e.error);var t="";e.error.errors&&e.error.errors.forEach(function(e){t+=e.msg+" "+e.param+"\n"}),r.form.options.resetModel(),r.alert={type:"error",message:e.error.message,description:t}},function(){})}},{key:"loadAllProfil",value:function(){var e=this;this.httpService.getData(this.hasPermissionToShowAllEntityData?"".concat(O.T5,"/profile-menus/deep"):"".concat(O.T5,"/profile-menus/byEntity/deep/").concat(this.user.entity.id)).toPromise().then(function(t){console.log(t);var o=t.body.rows;e.hasPermissionToShowDataRoot||(o=o.filter(function(e){return"PROF_ROOT"!=e.code})),o=o.map(function(e){return{key:e.id,title:e.label,label:e.label,menus:e.menus}}),e.form.fields=e.mapFields(Z,"profile_id","templateOptions.options",o),e.form.fields[1].fieldGroup[0].fieldGroup[0].templateOptions.options=o,0==o.length&&(e.form.options.formState.showCreateText=!1)}).catch(function(t){e.logger.error(t)})}},{key:"loadAllmenu",value:function(){var e=this;console.log("load menus"),this.user&&!this.user.is_root?(this.isSpinning=!1,console.log("menus user => ",this.user.menus),this.form.fields=this.mapFields(Z,"menu_id","templateOptions.options",J(this.user.menus))):this.httpService.getData("".concat(O.T5,"/menus/deep")).toPromise().then(function(t){var o=t.body.rows;o=J(o),e.logger.log("menus load => ",o),e.isSpinning=!1,e.form.fields=e.mapFields(Z,"menu_id","templateOptions.options",o)}).catch(function(t){e.logger.error(t)})}}]),o}(b.K);return e.\u0275fac=function(t){return new(t||e)(k.Y36(x.Kf),k.Y36(E.O),k.Y36(A.L),k.Y36(_.dD),k.Y36(P.e),k.Y36(w.h))},e.\u0275cmp=k.Xpm({type:e,selectors:[["profil-menu"]],features:[k.qOj],decls:2,vars:5,consts:[["nzTip","Chargement...",3,"nzSpinning"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(k.TgZ(0,"nz-spin",0),k.TgZ(1,"wl-form",1),k.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),k.qZA(),k.qZA()),2&e&&(k.Q6J("nzSpinning",t.isSpinning),k.xp6(1),k.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options))},directives:[f.W,d.U],styles:["[_nghost-%COMP%]{background:#fff;padding:10px!important;display:block}  .p-divider .p-divider-content{background-color:#f0f2f5}"]}),e}();function J(e,t){return e.map(function(e){var o,i;return{key:e.id,title:e[t]||e.label,label:e[t]||e.label,isLeaf:!(null===(o=e.sub)||void 0===o?void 0:o.length),children:J(e.sub,t),permission:null===(i=e.permission)||void 0===i?void 0:i.split(",").map(function(e){return{label:O._.capitalize(e),value:e}})}})}var H={},B={},Q=[{template:"<p>Vous pouvez ajouter des permissions \xe0 un profil en selectionnant les permissions que vous voulez lui attribuer.</p>"},{fieldGroupClassName:"d-flex flex-wrap flex-start",fieldGroup:[{className:"flex-5",key:"profile_id",type:"select",templateOptions:{required:!0,translate:!0,label:"Profil",options:[],valueProp:"id",labelProp:"label",onModelChange:function(e,t){var o=e.templateOptions.options.find(function(e){return e.id==t});if(o){var i=e.parent.fieldGroup[1].templateOptions.options;i=null==i?void 0:i.map(function(e){var t;return(null===(t=o.permissions)||void 0===t?void 0:t.map(function(e){return e.id}).includes(e.id))?Object.assign(Object.assign({},e),{direction:"right"}):Object.assign(Object.assign({},e),{direction:"left"})}),e.parent.fieldGroup[1].templateOptions.options=i,e.form.get("permission_id").setValue(o.permissions)}}}},{className:"flex-10",key:"permission_id",type:"transfert",templateOptions:{translate:!0,required:!0,right:"Attribuer",left:"Retirer",showCode:!0,label:"Description",change:function(e,t){var o=e.templateOptions.options.filter(function(e){return"right"==e.direction});e.formControl.setValue(o)}}},{className:"flex-1",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,o){return!o.form.valid}}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.options.resetModel(H)}}}]}],W=function(){var e=function(e){a(o,e);var t=l(o);function o(e,n,r,a,s,l,c){var u;i(this,o),(u=t.call(this,e,n,r,a,s,l)).logger=e,u.httpService=n,u.envService=r,u.messageService=a,u.authService=s,u.menuService=l,u.cdRef=c;var d=u.authService.hasPermissionAuthorizationV2(["SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);return u.hasPermissionToShowAllEntityData=d[0],u.hasPermissionToShowDataRoot=d[1],u}return r(o,[{key:"ngOnInit",value:function(){this.form.model=H,this.form.fields=Q,this.form.options=B,this.loadAllProfilPermission(),this.loadAllPermission()}},{key:"save",value:function(e){var t,o,i=this;this.logger.log("model: ",e.model);var n=(null===(t=e.model.permission_id)||void 0===t?void 0:t.length)?null===(o=e.model.permission_id)||void 0===o?void 0:o.map(function(t){return{profile_id:e.model.profile_id,permission_id:t.id,status:e.model.status,added_user:i.user.id}}):[{profile_id:e.model.profile_id,permission_id:null,status:e.model.status,session:this.user.session_id,added_user:this.user.id}];this.logger.log("save user-profil ==> ",n),this.httpService.postData("".concat(O.T5,"/profile-permissions"),n).subscribe(function(e){i.logger.log("postData response ===> ",e),i.setMessage("success","Enregistrement effectu\xe9 avec succ\xe8s !"),setTimeout(function(){i.form.options.resetModel(),i.loadAllProfilPermission(),i.loadAllPermission()},1e3)},function(e){i.logger.log("postData error ===> ",e),i.setBackendError(e.error);var t="";e.error.errors&&e.error.errors.forEach(function(e){t+=e.msg+" "+e.param+"\n"}),i.alert={type:"error",message:e.error.message,description:t}},function(){})}},{key:"loadAllPermission",value:function(){var e=this;this.httpService.getData("".concat(O.T5,"/permissions")).toPromise().then(function(t){var o=t.body.rows;o=o.map(function(e){return Object.assign(Object.assign({},e),{title:e[void 0]||e.code,direction:"left"})}),e.form.fields=e.mapFields(e.form.fields,"permission_id","templateOptions.options",o)}).catch(function(t){e.logger.error(t)})}},{key:"loadAllProfilPermission",value:function(){var e=this;this.httpService.getData(this.hasPermissionToShowAllEntityData?"".concat(O.T5,"/profile-permissions/deep"):"".concat(O.T5,"/profile-permissions/byEntity/deep/").concat(this.user.entity.id)).toPromise().then(function(t){e.isSpinning=!1;var o=t.body.rows;e.hasPermissionToShowDataRoot||(o=o.filter(function(e){return"PROF_ROOT"!=e.code})),e.form.fields=e.mapFields(e.form.fields,"profile_id","templateOptions.options",t.body.rows)}).catch(function(t){e.logger.error(t)})}}]),o}(b.K);return e.\u0275fac=function(t){return new(t||e)(k.Y36(x.Kf),k.Y36(E.O),k.Y36(A.L),k.Y36(_.dD),k.Y36(P.e),k.Y36(w.h),k.Y36(k.sBO))},e.\u0275cmp=k.Xpm({type:e,selectors:[["profil-permission"]],features:[k.qOj],decls:2,vars:5,consts:[["nzTip","Chargement...",3,"nzSpinning"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(k.TgZ(0,"nz-spin",0),k.TgZ(1,"wl-form",1),k.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),k.qZA(),k.qZA()),2&e&&(k.Q6J("nzSpinning",t.isSpinning),k.xp6(1),k.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options))},directives:[f.W,d.U],styles:["[_nghost-%COMP%]{background:#fff;padding:10px!important;display:block}"]}),e}(),X={},$={},ee=[{template:"<p>Vous pouvez ajouter des menus \xe0 votre progiciel.</p>"},{fieldGroup:[{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-5  wl-hidden",key:"id",type:"input",templateOptions:{translate:!0,label:"ID",readonly:!0}},{className:"flex-5",key:"code",type:"input",templateOptions:{translate:!0,label:"Code"},expressionProperties:{"model.code":function(e,t,o){if(e.code)return e.code.toUpperCase().split(" ").join("_")}}},{className:"flex-5",key:"label",type:"input",templateOptions:{translate:!0,label:"Libelle",required:!0}},{className:"flex-7",key:"description",type:"input",templateOptions:{translate:!0,label:"Description"}},{className:"flex-3",key:"parent_code",type:"select",templateOptions:{translate:!0,label:"Menu parent",options:[],showSearch:!0,allowClear:!0,valueProp:"code",labelProp:"label",onModelChange:function(e){var t,o=(null===(t=e.templateOptions.options.filter(function(t){return t.code==e.formControl.value})[0])||void 0===t?void 0:t.routing)||"";e.form.get("namespace").setValue(o)}}},{className:"flex-3",key:"namespace",type:"input",templateOptions:{translate:!0,required:!0,label:"Namespace",readonly:!1,change:function(e){if(!e.model.parent_code){var t=e.formControl.value;e.form.get("routing").setValue(t)}}},expressionProperties:{"templateOptions.readonly":"model.parent_code"}},{className:"flex-4",key:"routing",type:"input",templateOptions:{translate:!0,label:"Path"},expressionProperties:{"templateOptions.addOnBefore":function(e,t,o){if(e.parent_code)return o.form.get("namespace").value},"templateOptions.readonly":"!model.parent_code && model.namespace"}},{className:"flex-2",key:"icon",type:"select",templateOptions:{translate:!0,showSearch:!0,allowClear:!0,label:"Icone",withIcon:!0,options:[{label:"user",value:"user",icon:"user"},{label:"mail",value:"mail",icon:"mail"},{label:"setting",value:"setting",icon:"setting"},{label:"code",value:"code",icon:"code"},{label:"control",value:"control",icon:"control"},{label:"container",value:"container",icon:"container"},{label:"database",value:"database",icon:"database"},{label:"dashboard",value:"dashboard",icon:"dashboard"},{label:"bank",value:"bank",icon:"bank"},{label:"line",value:"line",icon:"line"},{label:"step-backward",value:"step-backward",icon:"step-backward"},{label:"step-forward",value:"step-forward",icon:"step-forward"},{label:"fast-backward",value:"fast-backward",icon:"fast-backward"},{label:"fast-forward",value:"fast-forward",icon:"fast-forward"},{label:"shop",value:"shop",icon:"shop"},{label:"menu",value:"menu",icon:"menu"},{label:"calendar",value:"calendar",icon:"calendar"},{label:"file-text",value:"file-text",icon:"file-text"},{label:"apartment",value:"apartment",icon:"apartment"},{label:"team",value:"team",icon:"team"},{label:"tool",value:"tool",icon:"tool"},{label:"appstore",value:"appstore",icon:"appstore"},{label:"star",value:"star",icon:"star"},{label:"key",value:"key",icon:"key"},{label:"form",value:"form",icon:"form"},{label:"pie-chart",value:"pie-chart",icon:"pie-chart"},{label:"area-chart",value:"area-chart",icon:"area-chart"},{label:"stock",value:"stock",icon:"stock"},{label:"rise",value:"rise",icon:"rise"},{label:"fall",value:"fall",icon:"fall"},{label:"api",value:"api",icon:"api"},{label:"disconnect",value:"disconnect",icon:"disconnect"},{label:"desktop",value:"desktop",icon:"desktop"},{label:"contacts",value:"contacts",icon:"contacts"},{label:"comment",value:"comment",icon:"comment"},{label:"credit-card",value:"credit-card",icon:"credit-card"},{label:"audit",value:"audit",icon:"audit"}]},defaultValue:"line"},{className:"flex-10",key:"permission",type:"select",templateOptions:{translate:!0,required:!0,mode:"tags",label:"Actions possible",icon:"pi pi-shield",options:[{label:"CREATE",value:"CREATE"},{label:"EDIT",value:"EDIT"},{label:"DELETE",value:"DELETE"},{label:"EXPORT",value:"EXPORT"},{label:"CONSULT",value:"CONSULT"}],placeholder:"Saisie les actions possible pour ce menu"},defaultValue:[{label:"CREATE",value:"CREATE"},{label:"EDIT",value:"EDIT"},{label:"DELETE",value:"DELETE"},{label:"EXPORT",value:"EXPORT"},{label:"CONSULT",value:"CONSULT"}].map(function(e){return e.value})},{className:"flex-1",key:"order",type:"input",templateOptions:{required:!0,type:"number",translate:!0,label:"Ordre"},defaultValue:!0},{className:"flex-2",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0},{className:"flex-2",key:"is_module",type:"checkbox",templateOptions:{translate:!0,label:"Est module ?"},defaultValue:!1},{className:"flex-2",key:"is_group_title",type:"checkbox",templateOptions:{translate:!0,label:"Est titre de groupe?"},defaultValue:!1,hideExpression:"model.is_module",expressionProperties:{}},{className:"flex-2",key:"is_load_menu",type:"checkbox",templateOptions:{translate:!0,label:"Charge menu ?"},hideExpression:"!model.is_module",expressionProperties:{"templateOptions.required":"model.is_module"}}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{key:"submit",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:function(e){console.log("clik on submit"),e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,o){return!o.form.valid}}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.options.resetModel(X)}}}]}]}];function te(e,t){if(1&e){var o=k.EpF();k.TgZ(0,"wl-form",7),k.NdJ("onSubmit",function(e){return k.CHM(o),k.oxw().save(e)})("onModelChange",function(e){return k.CHM(o),k.oxw().modelChange(e)}),k.qZA()}if(2&e){var i=k.oxw();k.Q6J("alert",i.alert)("model",i.form.model)("fields",i.form.fields)("options",i.form.options)}}var oe,ie,ne=function(){var e=function(e){a(o,e);var t=l(o);function o(e,n,r,a,s,l,c,u){var d;i(this,o),(d=t.call(this,e,n,r,a,s,l,c)).logger=e,d.httpService=n,d.envService=r,d.messageService=a,d.authService=s,d.menuService=l,d.modal=c,d.changeDetectorRef=u,d.isEditMode=!1,d.isVisible=!1;var p=d.authService.hasPermissionAuthorizationV2(["USER_LIST.CREATE","USER_LIST.LOCK","USER_LIST.EDIT","USER_LIST.UNLOCK","USER_LIST.EXPORT","USER_LIST.DELETE","SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);return d.hasPermissionToLock=p[1],d.hasPermissionToEdit=p[2],d.hasPermissionToUnlock=p[3],d.hasPermissionToExport=p[4],d.hasPermissionToDelete=p[5],d.hasPermissionToShowAllEntityData=p[6],d.hasPermissionToShowDataRoot=p[7],d.hasPermissionToCreate=p[0],d}return r(o,[{key:"maFonction",value:function(){this.form.fields[0].template="<p>Veuillez remplir ce formulaire pour cr\xe9er un menu.</p>",this.isVisible=!0,this.isEditMode=!1,this.form.model=Object.assign({},X)}},{key:"modalTitle",get:function(){return this.isEditMode?"Mise \xe0 jour":"Ajouter"}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnInit",value:function(){var e=this;this.form.model=Object.assign({},X),this.form.fields=ee,this.form.options=$,this.loadAllmenu(),this.globalFilterFields=["code","label"],this.columns=[{field:"code",header:"Code"},{field:"label",header:"Libelle"},{field:"description",header:"Description"},{field:"status",header:"STATUS",type:"status",falseText:"Non",trueText:"Oui"},{field:"created_at",header:"CREATED_AT",type:"date"}],this.user&&this.hasPermissionToEdit&&this.actions.push({type:"default",icon:"edit",shape:"circle",loading:!1,click:function(t){e.edit(t),e.logger.log(t),e.isEditMode=!0,e.isVisible=!0,console.log(t),e.form.fields[0].template="<p>Veuillez renseigner ce formulaire pour modifier les informations dudit menu.</p>",setTimeout(function(){e.alert=void 0,t.status=0!=t.status,e.form.model=Object.assign({},t),e.form.fields[0].fieldGroup[0].template="<h5>Vous modifiez de l'utilisateur <i>".concat(t.login,"</i> </h5>"),e.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="Enregistrer",e.changeDetectorRef.detectChanges()},1)}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"warning",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:function(t){e.swingstatus(t)},cancel:function(e){}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:function(t){e.delete(t,"menus",!1,function(t){e.changeDetectorRef.detectChanges()})},cancel:function(e){}})}},{key:"save",value:function(e){var t,o=this;if(console.log(e),1==this.isEditMode){this.changeDetectorRef.detectChanges(),this.logger.log("event.model: ",e.model);var i=Object.assign(Object.assign({},e.model),{phone:e.model.prefix+" "+e.model.phone,session:this.user.session_id});this.logger.log("payload ",i);var n=i.id;i=O._.omit(i,["id"]),i=Object.assign(Object.assign({},i),{updated_user:this.user.id}),this.putData("".concat(O.T5,"/menus/").concat(n),i,function(e){e instanceof T.UA||(o.loadData(o.currentLoadEvent),o.isVisible=!1)})}else{this.logger.log("model: ",e.model);var r=Object.assign(Object.assign({},e.model),{routing:e.model.parent_code?e.model.namespace+"/"+e.model.routing:e.model.namespace,permission:null===(t=e.model.permission)||void 0===t?void 0:t.join(",").toUpperCase(),order:parseInt(e.model.order),session:this.user.session_id});if((r=O._.omit(r,["right"])).id&&null!=r.id){var a=r.id;r=O._.omit(r,["id"]),r=Object.assign(Object.assign({},r),{updated_user:this.user.id}),this.putData("".concat(O.T5,"/menus/").concat(a),r,function(e){o.form.options.resetModel(),e instanceof T.UA||(o.form.fields=o.mapFields(o.form.fields,"parent_code","templateOptions.options",o.data),o.changeDetectorRef.detectChanges())})}else r=O._.omit(r,["id"]),r=Object.assign(Object.assign({},r),{added_user:this.user.id}),this.postData("".concat(O.T5,"/menus"),r,function(e){o.form.options.resetModel(),e instanceof T.UA||(o.form.fields=o.mapFields(o.form.fields,"parent_code","templateOptions.options",o.data),o.changeDetectorRef.detectChanges())})}}},{key:"swingstatus",value:function(e){var t=this,o=e.id,i=e.status;if(1==i){var n=O._.omit(e,["id"]);n={status:!1,updated_user:this.user.id},this.putData("".concat(O.T5,"/menus/").concat(o),n,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})}if(0==i){var r=O._.omit(e,["id"]);r={status:!0,updated_user:this.user.id},this.putData("".concat(O.T5,"/menus/").concat(o),r,function(e){e instanceof T.UA||t.loadData(t.currentLoadEvent)})}}},{key:"loadData",value:function(e){var t=this;this.loading=!0,this.currentLoadEvent=e,this.getData("".concat(this.hasPermissionToShowAllEntityData?"".concat(O.T5,"/menus/"):"".concat(O.T5,"/menus"),"?page=").concat(e.first/e.rows+1,"&per_page=").concat(e.rows).concat(null!=e.globalFilter?'&search={"sKey":"all","sValue":"'.concat(e.globalFilter,'"}'):"").concat(e.sortField&&null!=e.sortField?'&sort=[{"sortField":"'.concat(e.sortField,'","sortOrder":"').concat(1==e.sortOrder?"ASC":"DESC",'"}]'):'&sort=[{"sortField":"id","sortOrder":"DESC"}]'),function(e){if(!(e instanceof T.UA)){var o=e.body.rows;t.user&&!t.user.is_root&&(o=o.filter(function(e){return!e.is_root})),t.hasPermissionToShowDataRoot||(o=o.filter(function(e){return!e.profiles.map(function(e){return e.code}).includes("PROF_ROOT")})),o=o.map(function(e){return Object.assign(Object.assign({},e),{trClass:e.status?"Actif":"Inactif"})}),t.data=o,t.loading=!1,t.changeDetectorRef.detectChanges()}})}},{key:"loadAllmenu",value:function(){var e=this;this.httpService.getData("".concat(O.T5,"/menus")).toPromise().then(function(t){e.form.fields=e.mapFields(ee,"parent_code","templateOptions.options",t.body.rows),e.changeDetectorRef.detectChanges()}).catch(function(t){e.logger.error(t)})}},{key:"loadAllpermission",value:function(){var e=this;this.httpService.getData("".concat(O.T5,"/menus")).toPromise().then(function(t){e.form.fields=e.mapFields(ee,"parent_code","templateOptions.options",t.body.rows),e.changeDetectorRef.detectChanges()}).catch(function(t){e.logger.error(t)})}},{key:"handleCancel",value:function(){this.isVisible=!1}}]),o}(b.K);return e.\u0275fac=function(t){return new(t||e)(k.Y36(x.Kf),k.Y36(E.O),k.Y36(A.L),k.Y36(_.dD),k.Y36(P.e),k.Y36(w.h),k.Y36(m.Sf),k.Y36(k.sBO))},e.\u0275cmp=k.Xpm({type:e,selectors:[["menu-component"]],features:[k.qOj],decls:11,vars:18,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[2,"width","100%","text-align","center"],[2,"border","3px dashed whitesmoke","padding","400px"],[2,"font-size","small"],[1,"button-19",2,"margin-left","20px",3,"click"],[3,"data","styleClass","showTools","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(k.TgZ(0,"nz-modal",0),k.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),k.YNc(1,te,1,4,"wl-form",1),k.qZA(),k._UZ(2,"br"),k.TgZ(3,"table",2),k.TgZ(4,"tr",3),k.TgZ(5,"td"),k.TgZ(6,"h5",4),k._uU(7," Ajouter un menu en cliquant sur ce bouton "),k.TgZ(8,"button",5),k.NdJ("click",function(){return t.maFonction()}),k._uU(9,"Ajouter"),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.qZA(),k.TgZ(10,"wl-table",6),k.NdJ("onLazyLoad",function(e){return t.loadData(e)}),k.qZA()),2&e&&(k.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),k.xp6(10),k.Udp("margin-top","1rem"),k.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("showTools",t.hasPermissionToExport)("columns",t.columns)("showTools",!0)("actions",t.actions)("lazy",!0)("caption","Menus")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[m.du,m.Hf,p.a,d.U],styles:[".search-input .inline{display:inline-block;margin:0!important;padding:0!important}  .search-input .inline nz-input-group{border-radius:.2rem 0 0 .2rem!important}  .search-input .inline:last-child button{border-radius:0 0 10px 0}  .search-input .inline:last-child{position:relative;top:1.8rem;left:-1.5px;margin:0;padding:0}  .search-input .inline:last-child nz-input-group{border-radius:0 .2rem .2rem 0!important}  .button-19{background:#0d6d3a;border:1px solid #0d6d3a;border-radius:6px;box-shadow:1px 2px 4px rgba(0,0,0,.1);box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:nunito,roboto,proxima-nova,proxima nova,sans-serif;font-size:13px;font-weight:800;line-height:16px;min-height:40px;outline:0;padding:12px 14px;text-align:center;text-rendering:geometricprecision;text-transform:none;-moz-user-select:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle}  .button-19:active,   .button-19:hover{background-color:transparent;background-color:initial;background-position:0 0;color:#0d6d3a}"],changeDetection:0}),e}(),re=function(){var e=function(){function e(t,o){i(this,e),this.router=t,this.authService=o}return r(e,[{key:"canActivate",value:function(e,t){return!!this.authService.hasMenuAuthorization("MENU")||(this.router.navigate(["/private"]),!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.LFG(g.F0),k.LFG(P.e))},e.\u0275prov=k.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ae=function(){var e=function(){function e(t,o){i(this,e),this.router=t,this.authService=o}return r(e,[{key:"canActivate",value:function(e,t){return!!this.authService.hasMenuAuthorization("PROFIL")||(this.router.navigate(["/private"]),!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.LFG(g.F0),k.LFG(P.e))},e.\u0275prov=k.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),se=function(){var e=function(){function e(t,o){i(this,e),this.router=t,this.authService=o}return r(e,[{key:"canActivate",value:function(e,t){return!!this.authService.hasMenuAuthorization("PROFIL_MENU")||(this.router.navigate(["/private"]),!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.LFG(g.F0),k.LFG(P.e))},e.\u0275prov=k.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),le=function(){var e=function(){function e(t,o){i(this,e),this.router=t,this.authService=o}return r(e,[{key:"canActivate",value:function(e,t){return!!this.authService.hasMenuAuthorization("PROFIL_PERM")||(this.router.navigate(["/private"]),!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.LFG(g.F0),k.LFG(P.e))},e.\u0275prov=k.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ce=function(){var e=function(){function e(t,o){i(this,e),this.router=t,this.authService=o}return r(e,[{key:"canActivate",value:function(e,t){return!!this.authService.hasMenuAuthorization("PERMISSION")||(this.router.navigate(["/private"]),!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(k.LFG(g.F0),k.LFG(P.e))},e.\u0275prov=k.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ue=[{path:"",component:(oe=function(e){a(o,e);var t=l(o);function o(e,n,r,a,s,l){var c;return i(this,o),(c=t.call(this,e,n,r,a,s,l)).logger=e,c.httpService=n,c.envService=r,c.messageService=a,c.authService=s,c.menuService=l,c}return r(o,[{key:"ngOnInit",value:function(){}}]),o}(b.K),oe.\u0275fac=function(e){return new(e||oe)(k.Y36(x.Kf),k.Y36(E.O),k.Y36(A.L),k.Y36(_.dD),k.Y36(P.e),k.Y36(w.h))},oe.\u0275cmp=k.Xpm({type:oe,selectors:[["access-management"]],features:[k.qOj],decls:2,vars:0,template:function(e,t){1&e&&(k.TgZ(0,"p"),k._uU(1," access-management works "),k.qZA())},styles:[""]}),oe)},{path:"profile",component:L,canActivate:[ae],data:{title:"Profile",breadcrumb:"Profile"}},{path:"permission",component:U,canActivate:[ce],data:{title:"Permission",breadcrumb:"Permission"}},{path:"profile-menu",canActivate:[se],component:K,data:{title:"Droit d'acc\xe8s",breadcrumb:"Droit d'acc\xe8s"}},{path:"profile-permission",canActivate:[le],component:W,data:{title:"Permission profil",breadcrumb:"Permission profil"}},{path:"menu",canActivate:[re],component:ne,data:{title:"Menu",breadcrumb:"Menu"}}],de=function(){var e=r(function e(){i(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=k.oAB({type:e}),e.\u0275inj=k.cJS({imports:[[g.Bz.forChild(ue)],g.Bz]}),e}(),pe=((ie=r(function e(){i(this,e)})).\u0275fac=function(e){return new(e||ie)},ie.\u0275mod=k.oAB({type:ie}),ie.\u0275inj=k.cJS({imports:[[c.ez,u.u5,u.UX,de,d.e,p.n,m.Qp,f.j,h.Q]]}),ie)}}])}();