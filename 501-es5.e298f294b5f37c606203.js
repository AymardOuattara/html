!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(o=i.key,n=void 0,"symbol"==typeof(n=function(e,t){if("object"!=typeof e||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"))?n:String(n)),i)}var o,n}function a(e,a,i){return a&&t(e.prototype,a),i&&t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function o(e,t){return(o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function n(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var a,i=r(e);if(t){var o=r(this).constructor;a=Reflect.construct(i,arguments,o)}else a=i.apply(this,arguments);return l(this,a)}}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(self.webpackChunkwil_admin_angular=self.webpackChunkwil_admin_angular||[]).push([[501],{87501:function(t,o,l){"use strict";l.r(o),l.d(o,{CheckoutFormModule:function(){return G}});var r=l(38583),s=l(3679),d=l(977),c=l(65461),u=l(66782),p=l(98542),f=l(95987),m=l(99688),b=l(37716),y=l(44212),g=l(18859),_=l(52121),v=l(68058),h=l(4768),O=l(28723),N=function(){var t=function(t){i(l,t);var o=n(l);function l(t,a,i,n,r,s){var d;return e(this,l),(d=o.call(this,t,a,i,n,r,s)).logger=t,d.httpService=a,d.envService=i,d.messageService=n,d.authService=r,d.menuService=s,d}return a(l,[{key:"ngOnInit",value:function(){var e=this;this.isSpinning=!1,this.globalFilterFields=["id"],this.columns=[{field:"id",header:"ID"},{field:"status",header:"STATUS",type:"status"},{field:"created_at",header:"CREATED_AT",type:"date"},{field:"updated_at",header:"UPDATED_AT",type:"date"}],this.actions=[{type:"default",icon:"edit",shape:"circle",loading:!1,click:function(t){e.edit(t),e.form.model=Object.assign({},t)}},{type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Are-you sure ?",loading:!1,click:function(t){e.delete(t,"checkout-form")},cancel:function(e){}}]}},{key:"save",value:function(e){this.logger.log("model: ",e.model);var t=Object.assign({},e.model);t=Object.assign(Object.assign({},t),t.id&&null!=t.id?{updated_user:this.user.id}:{added_user:this.user.id})}},{key:"loadData",value:function(e){var t=this;console.log(e),setTimeout(function(){t.loading=!0},1e3)}}]),l}(m.K);return t.\u0275fac=function(e){return new(e||t)(b.Y36(y.Kf),b.Y36(g.O),b.Y36(_.L),b.Y36(v.dD),b.Y36(h.e),b.Y36(O.h))},t.\u0275cmp=b.Xpm({type:t,selectors:[["checkout-form"]],features:[b.qOj],decls:3,vars:18,consts:[["nzTip","Loading...",3,"nzSpinning"],[3,"alert","model","fields","options","onSubmit","onModelChange"],[3,"data","wrapper","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"]],template:function(e,t){1&e&&(b.TgZ(0,"nz-spin",0),b.TgZ(1,"wl-form",1),b.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),b.qZA(),b.qZA(),b.TgZ(2,"wl-table",2),b.NdJ("onLazyLoad",function(e){return t.loadData(e)}),b.qZA()),2&e&&(b.Q6J("nzSpinning",t.isSpinning),b.xp6(1),b.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options),b.xp6(1),b.Udp("margin-top","1rem"),b.Q6J("data",t.data)("wrapper","fieldset")("columns",t.columns)("actions",t.actions)("lazy",!0)("caption","CheckoutForm ")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[u.W,c.U,d.a],styles:[""]}),t}(),x=l(42394),k=l(91841);function C(e,t){if(1&e){var a=b.EpF();b.TgZ(0,"wl-form",3),b.NdJ("onSubmit",function(e){return b.CHM(a),b.oxw().save(e)})("onModelChange",function(e){return b.CHM(a),b.oxw().modelChange(e)}),b.qZA()}if(2&e){var i=b.oxw();b.Q6J("alert",i.alert)("model",i.form.model)("fields",i.form.fields)("options",i.form.options)}}function w(e,t){if(1&e){var a=b.EpF();b.TgZ(0,"wl-form",3),b.NdJ("onSubmit",function(e){return b.CHM(a),b.oxw().save(e)})("onModelChange",function(e){return b.CHM(a),b.oxw().modelChange(e)}),b.qZA()}if(2&e){var i=b.oxw();b.Q6J("alert",i.alert)("model",i.form.model)("fields",i.form.fields)("options",i.form.options)}}var A,T,D,F,V=[{path:"",component:N,data:{title:"CheckoutForm",breadcrumb:"CheckoutForm"}},{path:"checkout-form",component:N,data:{title:"CheckoutForm",breadcrumb:"CheckoutForm"}},{path:"checkout-form-create",component:(D=function(t){i(l,t);var o=n(l);function l(t,a,i,n,r,s){var d;return e(this,l),(d=o.call(this,t,a,i,n,r,s)).logger=t,d.httpService=a,d.envService=i,d.messageService=n,d.authService=r,d.menuService=s,d.model={configs:[{}]},d.options={},d.fields=[{template:"<center><p>Veuillez renseigner les informations relatives au ben\xe9ficiaire de la demande.</p></center>"},{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-3",key:"code_bon_vert",type:"input",templateOptions:{label:"Numero de bon",readonly:!0}},{className:"flex-3",key:"date_demande",type:"input",templateOptions:{label:"Date",type:"date"}}]},{wrappers:["fieldset-wrapper"],templateOptions:{label:"Demandeur : "+d.user.NOM_AGENT+" "+d.user.PNOM_AGENT},fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-5",key:"fonction_responsable",type:"input",templateOptions:{label:"Fonction du demandeur",readonly:!0,defaultValue:d.user.fonction.LIB_FONCT,required:!0}},{className:"flex-5",key:"matricule_demandeur",type:"input",templateOptions:{label:"Matricule"}},{className:"flex-5",key:"objet_demande",type:"select",templateOptions:{label:"Objet de la demande",required:!0,translate:!0,showSearch:!0,allowClear:!0,options:[]}},{className:"flex-5",key:"montant_bon_vert",type:"input",templateOptions:{label:"Valeur du bon",required:!0}},{className:"flex-10",key:"description_demande",type:"textarea",templateOptions:{label:"Description",placeholder:"Veuillez d\xe9crire le motif de votre demande",required:!0}},{}]},{template:"<br>"},{fieldGroupClassName:"d-flex flex-wrap",wrappers:["fieldset-wrapper"],templateOptions:{label:"B\xe9n\xe9ficiaire"},fieldGroup:[{className:"flex-2",key:"nom_beneficiaire",type:"input",templateOptions:{label:"Nom du b\xe9n\xe9ficiaire",required:!0}},{className:"flex-2",key:"prenom_beneficiaire",type:"input",templateOptions:{label:"Prenom du b\xe9n\xe9ficiaire",required:!0}},{className:"flex-2",key:"fonction_beneficiaire",type:"input",templateOptions:{label:"Fonction du b\xe9n\xe9ficiaire",required:!0}},{className:"flex-2",key:"matricule_beneficiaire",type:"input",templateOptions:{label:"Matricule du b\xe9n\xe9ficiaire"}},{className:"flex-10",key:"add_mandataire",type:"checkbox",templateOptions:{label:"Voulez vous attribuer un mandataire ?",click:function(e){e.form.get("add_mandataire").setValue(1)}}},{wrappers:["fieldset-wrapper"],fieldGroupClassName:"d-flex flex-wrap",hide:!0,templateOptions:{label:"Mandataire"},expressionProperties:{hide:"!model.add_mandataire"},fieldGroup:[{className:"flex-2",key:"nom_mandataire",type:"input",templateOptions:{label:"Nom du mandataire"}},{className:"flex-2",key:"prenom_mandataire",type:"input",templateOptions:{label:"Prenom du mandataire"}},{className:"flex-2",key:"fonction_mandataire",type:"input",templateOptions:{label:"fonction du mandataire"}},{className:"flex-2",key:"matricule_mandataire",type:"input",templateOptions:{label:"Matricule du mandataire"}}]},{className:"flex-8",key:"file_line",type:"file-upload",templateOptions:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",translate:!0,label:"Fichier justificatif de la date",handleUpload:function(e,t){var a=t[0],i=new FileReader;function o(t,a){return Object.keys(t).map(function(i){return"object"==typeof t[i]?o(t[i],i):{key:a?a+"."+i:i,value:t[i],lang_code:e.model.lang_code,status:!0}})}i.readAsText(a,"UTF-8"),i.onload=function(t){var a=JSON.parse(t.target.result);console.log(a),x._.mapKeys(a,function(e,t){return{key:t,value:e}});var i=x._.flattenDeep(o(a));console.log(i),e.formControl.setValue(i),e.options.formState.enableSubmitBtn=!0},i.onerror=function(e){console.log(e)}}}}]},{template:"<br>"},{wrappers:["fieldset-wrapper"],fieldGroupClassName:"d-flex flex-wrap",templateOptions:{label:"Centre d'imputation de la demande"},fieldGroup:[{className:"flex-3",key:"centre_imputation",type:"select",defaultValue:d.user.CODE_SERV,templateOptions:{label:"Centre",required:!0,translate:!0,showSearch:!0,allowClear:!0,options:[]}},{className:"flex-3",key:"activite",type:"select",templateOptions:{translate:!0,required:!0,showSearch:!0,allowClear:!0,label:"Activit\xe9",options:[]}},{className:"flex-3",key:"nature",type:"input",templateOptions:{label:"Nature",required:!0}}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{fieldGroup:[{key:"submit",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.valid}}},{type:"button",templateOptions:{label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.form.get("nomDemandeur").setValue(null),e.form.get("prenomDemandeur").setValue(null),e.form.get("fonctionDemandeur").setValue(null),e.form.get("matriculeDemandeur").setValue(null)}},expressionProperties:{hide:function(){return"COMPTABILITE"===d.user.profil.code}}}]}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{key:"submitDAF",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Valider demande",translate:!0,loading:!1,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)}),e.form.get("submitDAF").setValue(!0)}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.get("refuserDAF")||!a.form.get("submitDAF")||!a.form.valid},hide:function(){return"COMPTABILITE"!=d.user.profil.code}}},{key:"refuserDAF",className:"flex-1",type:"button",templateOptions:{label:"Rejeter demande",bgColor:"#000",textColor:"#fff",click:function(e){return e.form.get("refuserDAF").setValue(!0)}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.get("refuserDAF")||!a.form.get("submitDAF")||!a.form.valid},hide:function(){return"COMPTABILITE"!=d.user.profil.code}}},{className:"flex-10",key:"motifRejet",type:"textarea",templateOptions:{label:"Veuillez indiquer le motif de votre refus"},expressionProperties:{hide:"!model.refuserDAF"}},{className:"flex-1",key:"submitMotif",type:"button",templateOptions:{label:"Soumettre",colorType:"primary"},expressionProperties:{hide:"!model.refuserDAF"}},{className:"flex-1",key:"annulerRefus",type:"button",templateOptions:{colorType:"primary",bgColor:"#000",textColor:"#fff",label:"Annuler r\xe9fus",click:function(e){return e.form.get("refuserDAF").setValue(null)}},expressionProperties:{hide:"!model.refuserDAF"}}]}],d.user=d.authService.getUserInfos(),d}return a(l,[{key:"ngOnInit",value:function(){var e=this;this.form.model=this.model,this.form.options=this.options,this.form.fields=this.fields,this.isSpinning=!1,this.getDataBvert("".concat(x.VR,"/motif/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.lib_motif,value:null==e?void 0:e.code_motif}}),e.fields[2].fieldGroup[2].templateOptions.options=a}}),this.getDataBvert("".concat(x.VR,"/centre_imputation/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.libelle,value:null==e?void 0:e.code_centre_imputation}}),console.log(a),console.log("this.fields[6]"),e.fields[6].fieldGroup[0].templateOptions.options=a}}),this.getDataBvert("".concat(x.VR,"/activite/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.labelle,value:null==e?void 0:e.code_activite}}),console.log(a),e.fields[6].fieldGroup[1].templateOptions.options=a}})}},{key:"save",value:function(e){var t={pagent:this.user.CODE_AGENT,description_demande:e.model.description_demande,nom_beneficiaire:e.model.nom_beneficiaire,prenom_beneficiaire:e.model.prenom_beneficiaire,matricule_beneficiaire:e.model.matricule_beneficiaire,fonction_beneficiaire:e.model.fonction_beneficiaire,nom_mandataire:e.model.nom_mandataire,prenom_mandataire:e.model.prenom_mandataire,matricule_mandataire:e.model.matricule_mandataire,fonction_mandataire:e.model.fonction_mandataire,pmotif:e.model.objet_demande,centre_imputation:e.model.centre_imputation,activite:e.model.activite,nature:e.model.nature,montant_bon_vert:e.model.montant_bon_vert,flag_soumis:1,flag_valid:0};this.logger.log("model: ",e.model);var a=Object.assign({},e.model);a.code_bon_vert&&null!=a.code_bon_vert||this.postDataBvert("".concat(x.VR,"/bonvert/"),t)}},{key:"loadData",value:function(e){var t=this;console.log(e),setTimeout(function(){t.loading=!0},1e3)}}]),l}(m.K),D.\u0275fac=function(e){return new(e||D)(b.Y36(y.Kf),b.Y36(g.O),b.Y36(_.L),b.Y36(v.dD),b.Y36(h.e),b.Y36(O.h))},D.\u0275cmp=b.Xpm({type:D,selectors:[["checkout-form-create"]],features:[b.qOj],decls:3,vars:5,consts:[["nzTip","Loading...",3,"nzSpinning"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(b.TgZ(0,"nz-spin",0),b.TgZ(1,"wl-form",1),b.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),b.qZA(),b.qZA(),b._uU(2,"zz")),2&e&&(b.Q6J("nzSpinning",t.isSpinning),b.xp6(1),b.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options))},directives:[u.W,c.U],styles:[""]}),D),data:{title:"CheckoutFormCreate",breadcrumb:"CheckoutFormCreate"}},{path:"checkout-form-list",component:(T=function(t){i(l,t);var o=n(l);function l(t,a,i,n,r,s,d,c){var u;return e(this,l),(u=o.call(this,t,a,i,n,r,s,d)).logger=t,u.httpService=a,u.envService=i,u.messageService=n,u.authService=r,u.menuService=s,u.modal=d,u.changeDetectorRef=c,u.isVisible=!1,u.modalTitle="Mise \xe0 jour",u.model={configs:[{}]},u.options={},u.fields=[{template:"<center><p>Veuillez renseigner les informations relatives au ben\xe9ficiaire de la demande.</p></center>"},{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-3",key:"code_bon_vert",type:"input",templateOptions:{label:"Numero de bon",readonly:!0}},{className:"flex-3",key:"date_demande",type:"input",templateOptions:{label:"Date",type:"date"}}]},{wrappers:["fieldset-wrapper"],templateOptions:{label:"Demandeur : "+u.user.NOM_AGENT+" "+u.user.PNOM_AGENT},fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-5",key:"lib_fonct",type:"input",templateOptions:{label:"Fonction du demandeur",readonly:!0,defaultValue:u.user.fonction.LIB_FONCT,required:!0}},{className:"flex-5",key:"matricule_demandeur",type:"input",templateOptions:{label:"Matricule"}},{className:"flex-5",key:"objet_demande",type:"select",defaultValue:"",templateOptions:{label:"Objet de la demande",required:!0,translate:!0,showSearch:!0,allowClear:!0,options:[]}},{className:"flex-5",key:"montant_bon_vert",type:"input",templateOptions:{label:"Valeur du bon",required:!0}},{className:"flex-10",key:"description_demande",type:"textarea",templateOptions:{label:"Description",placeholder:"Veuillez d\xe9crire le motif de votre demande",required:!0}},{}]},{template:"<br>"},{fieldGroupClassName:"d-flex flex-wrap",wrappers:["fieldset-wrapper"],templateOptions:{label:"B\xe9n\xe9ficiaire"},fieldGroup:[{className:"flex-2",key:"nom_beneficiaire",type:"input",templateOptions:{label:"Nom du b\xe9n\xe9ficiaire",required:!0}},{className:"flex-2",key:"prenom_beneficiaire",type:"input",templateOptions:{label:"Prenom du b\xe9n\xe9ficiaire",required:!0}},{className:"flex-2",key:"fonction_beneficiaire",type:"input",templateOptions:{label:"Fonction du b\xe9n\xe9ficiaire",required:!0}},{className:"flex-2",key:"matricule_beneficiaire",type:"input",templateOptions:{label:"Matricule du b\xe9n\xe9ficiaire"}},{className:"flex-10",key:"add_mandataire",type:"checkbox",templateOptions:{label:"Voulez vous attribuer un mandataire ?",click:function(e){e.form.get("add_mandataire").setValue(1)}}},{wrappers:["fieldset-wrapper"],fieldGroupClassName:"d-flex flex-wrap",hide:!0,templateOptions:{label:"Mandataire"},expressionProperties:{hide:"!model.add_mandataire"},fieldGroup:[{className:"flex-2",key:"nom_mandataire",type:"input",templateOptions:{label:"Nom du mandataire"}},{className:"flex-2",key:"prenom_mandataire",type:"input",templateOptions:{label:"Prenom du mandataire"}},{className:"flex-2",key:"fonction_mandataire",type:"input",templateOptions:{label:"fonction du mandataire"}},{className:"flex-2",key:"matricule_mandataire",type:"input",templateOptions:{label:"Matricule du mandataire"}}]},{className:"flex-8",key:"file_line",type:"file-upload",templateOptions:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",translate:!0,label:"Fichier justificatif de la date",handleUpload:function(e,t){var a=t[0],i=new FileReader;function o(t,a){return Object.keys(t).map(function(i){return"object"==typeof t[i]?o(t[i],i):{key:a?a+"."+i:i,value:t[i],lang_code:e.model.lang_code,status:!0}})}i.readAsText(a,"UTF-8"),i.onload=function(t){var a=JSON.parse(t.target.result);console.log(a),x._.mapKeys(a,function(e,t){return{key:t,value:e}});var i=x._.flattenDeep(o(a));console.log(i),e.formControl.setValue(i),e.options.formState.enableSubmitBtn=!0},i.onerror=function(e){console.log(e)}}}}]},{template:"<br>"},{wrappers:["fieldset-wrapper"],fieldGroupClassName:"d-flex flex-wrap",templateOptions:{label:"Centre d'imputation de la demande"},fieldGroup:[{className:"flex-3",key:"centre",type:"select",defaultValue:"",templateOptions:{label:"centre_imputation",required:!0,translate:!0,showSearch:!0,allowClear:!0,options:[]}},{className:"flex-3",key:"activitee",type:"select",defaultValue:"",templateOptions:{label:"Activit\xe9",required:!0,translate:!0,showSearch:!0,allowClear:!0,options:[]}},{className:"flex-3",key:"nature",type:"input",templateOptions:{label:"Nature",required:!0}}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{fieldGroup:[{key:"submit",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Mettre \xe0 jour",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.valid},hide:function(e,t,a){return 1==e.flag_valid}}},{type:"button",templateOptions:{label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.form.get("nomDemandeur").setValue(null),e.form.get("prenomDemandeur").setValue(null),e.form.get("fonctionDemandeur").setValue(null),e.form.get("matriculeDemandeur").setValue(null)}},expressionProperties:{hide:function(e,t,a){return 1==e.flag_valid}}}]}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{key:"submitDAF",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Valider demande",translate:!0,loading:!1,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)}),e.form.get("submitDAF").setValue(!0)}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.get("refuserDAF")||!a.form.get("submitDAF")||!a.form.valid},hide:function(){return"COMPTABILITE"!=u.user.profil.code}}},{key:"refuserDAF",className:"flex-1",type:"button",templateOptions:{label:"Rejeter demande",bgColor:"#000",textColor:"#fff",click:function(e){return e.form.get("refuserDAF").setValue(!0)}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.get("refuserDAF")||!a.form.get("submitDAF")||!a.form.valid},hide:function(){return"COMPTABILITE"!=u.user.profil.code}}},{className:"flex-10",key:"motifRejet",type:"textarea",templateOptions:{label:"Veuillez indiquer le motif de votre refus"},expressionProperties:{hide:"!model.refuserDAF"}},{className:"flex-1",key:"submitMotif",type:"button",templateOptions:{label:"Soumettre",colorType:"primary"},expressionProperties:{hide:"!model.refuserDAF"}},{className:"flex-1",key:"annulerRefus",type:"button",templateOptions:{colorType:"primary",bgColor:"#000",textColor:"#fff",label:"Annuler r\xe9fus",click:function(e){return e.form.get("refuserDAF").setValue(null)}},expressionProperties:{hide:"!model.refuserDAF"}}]}],u.user=u.authService.getUserInfos(),u}return a(l,[{key:"ngOnInit",value:function(){var e=this;this.form.model=this.model,this.form.options=this.options,this.form.fields=this.fields,this.isSpinning=!1,this.getDataBvert("".concat(x.VR,"/motif/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.lib_motif,value:null==e?void 0:e.code_motif}}),e.fields[2].fieldGroup[2].templateOptions.options=a}}),this.getDataBvert("".concat(x.VR,"/centre_imputation/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.libelle,value:null==e?void 0:e.code_centre_imputation}}),console.log(a),console.log("this.fields[6]"),e.fields[6].fieldGroup[0].templateOptions.options=a}}),this.getDataBvert("".concat(x.VR,"/activite/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.labelle,value:null==e?void 0:e.code_activite}}),console.log("this.fields[6].fieldGroup[1]"),console.log(e.fields[6].fieldGroup[1]),e.fields[6].fieldGroup[1].templateOptions.options=a}}),this.globalFilterFields=["code_bon_vert"],this.columns=[{field:"code_bon_vert",header:"CODE BON VERT"},{field:"service",header:"SERVICE"},{field:"pagent",header:"NOM & PRENOM DEMANDEUR"},{field:"lib_fonct",header:"FONCTION DEMANDEUR"},{field:"nom",header:"NOM & PRENOM BENEFICIAIRE"},{field:"fonction_beneficiaire",header:"FONCTION BENEFICIAIRE"},{field:"matricule_beneficiaire",header:"MATRICULE BENEFICIAIRE"},{field:"objet_demand",header:"MOTIF"},{field:"status",header:"VALID\xe9",type:"status",falseText:"NON",trueText:"OUI"},{field:"montant_bon_vert",header:"MONTANT"},{field:"date_demande",header:"CREATED_AT",type:"date"},{field:"updated_at",header:"UPDATED_AT",type:"date"}],this.actions=[{type:"default",icon:"edit",shape:"circle",loading:!1,click:function(t){e.edit(t),e.logger.log(t),e.isVisible=!0,e.form.model=Object.assign({},t),setTimeout(function(){e.form.model=Object.assign({},t)},1),e.form.fields[2].fieldGroup[2].defaultValue=t.pmotif.code_motif,e.form.fields[6].fieldGroup[0].defaultValue=t.centre_imputation.code_centre_imputation,e.form.fields[6].fieldGroup[1].defaultValue=t.activite.code_activite}},{type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Are-you sure ?",loading:!1,click:function(t){e.delete(t,"checkout-form-list")},cancel:function(e){}}]}},{key:"save",value:function(e){var t=this;this.logger.log("model: ",e.model);var a=Object.assign({},e.model);if(a.code_bon_vert&&null!=a.code_bon_vert){var i=a.code_bon_vert;a=x._.omit(a,["code_bon_vert"]),this.putDataBvert("".concat(x.VR,"/bonvert/").concat(i),{pagent:this.user.CODE_AGENT,description_demande:e.model.description_demande,nom_beneficiaire:e.model.nom_beneficiaire,prenom_beneficiaire:e.model.prenom_beneficiaire,matricule_beneficiaire:e.model.matricule_beneficiaire,fonction_beneficiaire:e.model.fonction_beneficiaire,nom_mandataire:e.model.nom_mandataire,prenom_mandataire:e.model.prenom_mandataire,matricule_mandataire:e.model.matricule_mandataire,fonction_mandataire:e.model.fonction_mandataire,pmotif:e.model.objet_demande,centre_imputation:e.model.centre,activite:e.model.activitee,nature:e.model.nature,montant_bon_vert:e.model.montant_bon_vert,flag_soumis:1,flag_valid:0},function(e){e instanceof k.UA||t.handleCancel()})}else a=Object.assign(Object.assign({},a),{added_user:this.user.id})}},{key:"handleCancel",value:function(){this.isVisible=!1}},{key:"loadData",value:function(e){var t=this;this.loading=!0;var a=null!=e.globalFilter?"&search=".concat(e.globalFilter):"",i=this.user.CODE_AGENT;setTimeout(function(){t.getDataBvert("".concat(x.VR,"/bonvert/demandeur/").concat(i,"?page=").concat(e.first/e.rows+1,"&per_page=").concat(e.rows).concat(a),function(e){if(!(e instanceof k.UA)){var a=e.body.data;a=a.map(function(e){return Object.assign(Object.assign({},e),{objet_demand:null==e?void 0:e.pmotif.lib_motif,nom:(null==e?void 0:e.nom_beneficiaire)+" "+(null==e?void 0:e.prenom_beneficiaire),pagent:(null==e?void 0:e.pagent.nom_agent)+" "+(null==e?void 0:e.pagent.pnom_agent),service:null==e?void 0:e.pagent.code_serv.lib_serv,lib_fonct:null==e?void 0:e.pagent.code_fonct.lib_fonct,status:1==e.flag_valid})}),t.data=a}})},1)}}]),l}(m.K),T.\u0275fac=function(e){return new(e||T)(b.Y36(y.Kf),b.Y36(g.O),b.Y36(_.L),b.Y36(v.dD),b.Y36(h.e),b.Y36(O.h),b.Y36(p.Sf),b.Y36(b.sBO))},T.\u0275cmp=b.Xpm({type:T,selectors:[["checkout-form-list"]],features:[b.qOj],decls:3,vars:16,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[3,"data","wrapper","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(b.TgZ(0,"nz-modal",0),b.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),b.YNc(1,C,1,4,"wl-form",1),b.qZA(),b.TgZ(2,"wl-table",2),b.NdJ("onLazyLoad",function(e){return t.loadData(e)}),b.qZA()),2&e&&(b.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),b.xp6(2),b.Udp("margin-top","1rem"),b.Q6J("data",t.data)("wrapper","fieldset")("columns",t.columns)("actions",t.actions)("lazy",!0)("caption","CheckoutFormList ")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[p.du,p.Hf,d.a,c.U],styles:[""]}),T),data:{title:"CheckoutFormList",breadcrumb:"CheckoutFormList"}},{path:"checkout-form-validation",component:(A=function(t){i(l,t);var o=n(l);function l(t,a,i,n,r,s,d){var c;return e(this,l),(c=o.call(this,t,a,i,n,r,s)).logger=t,c.httpService=a,c.envService=i,c.messageService=n,c.authService=r,c.menuService=s,c.changeDetectorRef=d,c.isVisible=!1,c.modalTitle="Mise \xe0 jour",c.model={configs:[{}]},c.options={},c.fields=[{template:"<center><p>Veuillez renseigner les informations relatives au ben\xe9ficiaire de la demande.</p></center>"},{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-3",key:"code_bon_vert",type:"input",templateOptions:{label:"Numero de bon",readonly:!0}},{className:"flex-3",key:"date_demande",type:"input",templateOptions:{label:"Date",type:"date"}}]},{wrappers:["fieldset-wrapper"],templateOptions:{label:"Demandeur : "+c.user.NOM_AGENT+" "+c.user.PNOM_AGENT},fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-5",key:"lib_fonct",type:"input",templateOptions:{label:"Fonction du demandeur",readonly:!0,defaultValue:c.user.fonction.LIB_FONCT,required:!0}},{className:"flex-5",key:"matricule_demandeur",type:"input",templateOptions:{label:"Matricule",readonly:!0}},{className:"flex-5",key:"objet_demande",type:"select",defaultValue:"",templateOptions:{label:"Objet de la demande",required:!0,readonly:!0,translate:!0,showSearch:!0,allowClear:!0,options:[]}},{className:"flex-5",key:"montant_bon_vert",type:"input",templateOptions:{label:"Valeur du bon",required:!0,readonly:!0}},{className:"flex-10",key:"description_demande",type:"textarea",templateOptions:{label:"Description",placeholder:"Veuillez d\xe9crire le motif de votre demande",required:!0,readonly:!0}},{}]},{template:"<br>"},{fieldGroupClassName:"d-flex flex-wrap",wrappers:["fieldset-wrapper"],templateOptions:{label:"B\xe9n\xe9ficiaire"},fieldGroup:[{className:"flex-2",key:"nom_beneficiaire",type:"input",templateOptions:{label:"Nom du b\xe9n\xe9ficiaire",required:!0,readonly:!0}},{className:"flex-2",key:"prenom_beneficiaire",type:"input",templateOptions:{label:"Prenom du b\xe9n\xe9ficiaire",required:!0,readonly:!0}},{className:"flex-2",key:"fonction_beneficiaire",type:"input",templateOptions:{label:"Fonction du b\xe9n\xe9ficiaire",required:!0,readonly:!0}},{className:"flex-2",key:"matricule_beneficiaire",type:"input",templateOptions:{label:"Matricule du b\xe9n\xe9ficiaire",readonly:!0}},{className:"flex-10",key:"add_mandataire",type:"checkbox",templateOptions:{readonly:!0,label:"Voulez vous attribuer un mandataire ?",click:function(e){e.form.get("add_mandataire").setValue(1)}}},{wrappers:["fieldset-wrapper"],fieldGroupClassName:"d-flex flex-wrap",hide:!0,templateOptions:{readonly:!0,label:"Mandataire"},expressionProperties:{hide:"!model.add_mandataire"},fieldGroup:[{className:"flex-2",key:"nom_mandataire",type:"input",templateOptions:{readonly:!0,label:"Nom du mandataire"}},{className:"flex-2",key:"prenom_mandataire",type:"input",templateOptions:{readonly:!0,label:"Prenom du mandataire"}},{className:"flex-2",key:"fonction_mandataire",type:"input",templateOptions:{readonly:!0,label:"fonction du mandataire"}},{className:"flex-2",key:"matricule_mandataire",type:"input",templateOptions:{readonly:!0,label:"Matricule du mandataire"}}]},{className:"flex-8",key:"file_line",type:"file-upload",templateOptions:{accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",translate:!0,label:"Fichier justificatif de la date",handleUpload:function(e,t){var a=t[0],i=new FileReader;function o(t,a){return Object.keys(t).map(function(i){return"object"==typeof t[i]?o(t[i],i):{key:a?a+"."+i:i,value:t[i],lang_code:e.model.lang_code,status:!0}})}i.readAsText(a,"UTF-8"),i.onload=function(t){var a=JSON.parse(t.target.result);console.log(a),x._.mapKeys(a,function(e,t){return{key:t,value:e}});var i=x._.flattenDeep(o(a));console.log(i),e.formControl.setValue(i),e.options.formState.enableSubmitBtn=!0},i.onerror=function(e){console.log(e)}}}}]},{template:"<br>"},{wrappers:["fieldset-wrapper"],fieldGroupClassName:"d-flex flex-wrap",templateOptions:{label:"Centre d'imputation de la demande"},fieldGroup:[{className:"flex-3",key:"centre",type:"select",defaultValue:"",templateOptions:{required:!0,readonly:!0,translate:!0,showSearch:!0,allowClear:!0,label:"Centre",options:[]}},{className:"flex-3",key:"activitee",type:"select",defaultValue:"",templateOptions:{required:!0,readonly:!0,translate:!0,showSearch:!0,allowClear:!0,label:"Activit\xe9",options:[]}},{className:"flex-3",key:"nature",type:"input",templateOptions:{label:"Nature",readonly:!0,required:!0}}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{fieldGroup:[{key:"submit",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Valider",translate:!0,loading:!1,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.valid},hide:function(){return"COMPTABILITE"===c.user.profil.code}}},{type:"button",templateOptions:{label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:function(e){e.form.get("nomDemandeur").setValue(null),e.form.get("prenomDemandeur").setValue(null),e.form.get("fonctionDemandeur").setValue(null),e.form.get("matriculeDemandeur").setValue(null)}},expressionProperties:{hide:function(){return"COMPTABILITE"===c.user.profil.code}}}]}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{key:"submitDAF",className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Valider demande",translate:!0,loading:!1,colorType:"primary",click:function(e){e.templateOptions.loading=!0,e.form.statusChanges.subscribe(function(t){e.templateOptions.loading&&(e.templateOptions.loading=!1)}),e.form.get("submitDAF").setValue(!0)}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.get("refuserDAF")||!a.form.get("submitDAF")||!a.form.valid},hide:function(){return"COMPTABILITE"!=c.user.profil.code}}},{key:"refuserDAF",className:"flex-1",type:"button",templateOptions:{label:"Rejeter demande",bgColor:"#000",textColor:"#fff",click:function(e){return e.form.get("refuserDAF").setValue(!0)}},expressionProperties:{"templateOptions.disabled":function(e,t,a){return!a.form.get("refuserDAF")||!a.form.get("submitDAF")||!a.form.valid},hide:function(){return"COMPTABILITE"!=c.user.profil.code}}},{className:"flex-10",key:"motifRejet",type:"textarea",templateOptions:{label:"Veuillez indiquer le motif de votre refus"},expressionProperties:{hide:"!model.refuserDAF"}},{className:"flex-1",key:"submitMotif",type:"button",templateOptions:{label:"Soumettre",colorType:"primary"},expressionProperties:{hide:"!model.refuserDAF"}},{className:"flex-1",key:"annulerRefus",type:"button",templateOptions:{colorType:"primary",bgColor:"#000",textColor:"#fff",label:"Annuler r\xe9fus",click:function(e){return e.form.get("refuserDAF").setValue(null)}},expressionProperties:{hide:"!model.refuserDAF"}}]}],c}return a(l,[{key:"ngOnInit",value:function(){var e=this;this.form.model=this.model,this.form.options=this.options,this.form.fields=this.fields,this.isSpinning=!1,this.getDataBvert("".concat(x.VR,"/motif/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.lib_motif,value:null==e?void 0:e.code_motif}}),e.fields[2].fieldGroup[2].templateOptions.options=a}}),this.getDataBvert("".concat(x.VR,"/centre_imputation/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.libelle,value:null==e?void 0:e.code_centre_imputation}}),console.log(a),console.log("this.fields[6]"),e.fields[6].fieldGroup[0].templateOptions.options=a}}),this.getDataBvert("".concat(x.VR,"/activite/"),function(t){if(!(t instanceof k.UA)){var a=t.body.rows;a=a.map(function(e){return{label:null==e?void 0:e.labelle,value:null==e?void 0:e.code_activite}}),e.fields[6].fieldGroup[1].templateOptions.options=a}}),this.globalFilterFields=["code_bon_vert"],this.columns=[{field:"code_bon_vert",header:"CODE BON VERT"},{field:"service",header:"SERVICE"},{field:"pagent",header:"NOM & PRENOM DEMANDEUR"},{field:"lib_fonct",header:"FONCTION DEMANDEUR"},{field:"nom",header:"NOM & PRENOM BENEFICIAIRE"},{field:"fonction_beneficiaire",header:"FONCTION BENEFICIAIRE"},{field:"matricule_beneficiaire",header:"MATRICULE BENEFICIAIRE"},{field:"objet_demand",header:"MOTIF"},{field:"status",header:"VALID\xe9",type:"status",falseText:"NON",trueText:"OUI"},{field:"montant_bon_vert",header:"MONTANT"},{field:"date_demande",header:"CREATED_AT",type:"date"},{field:"updated_at",header:"UPDATED_AT",type:"date"}],this.actions=[{type:"default",icon:"edit",shape:"circle",loading:!1,click:function(t){e.edit(t),e.logger.log(t),e.isVisible=!0,e.form.model=Object.assign({},t),setTimeout(function(){e.form.model=Object.assign({},t),e.changeDetectorRef.detectChanges()},1),console.log("this.form.model"),console.log(e.form.model),console.log("event"),console.log(t),e.form.fields[2].fieldGroup[2].defaultValue=t.pmotif.code_motif,e.form.fields[6].fieldGroup[0].defaultValue=t.centre_imputation.code_centre_imputation,e.form.fields[6].fieldGroup[1].defaultValue=t.activite.code_activite}},{type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Are-you sure ?",loading:!1,click:function(t){e.delete(t,"checkout-form-list")},cancel:function(e){}}]}},{key:"save",value:function(e){var t=this;this.logger.log("model: ",e.model);var a=Object.assign({},e.model);if(a.code_bon_vert&&null!=a.code_bon_vert){var i=a.code_bon_vert;a=x._.omit(a,["code_bon_vert"]),this.putDataBvert("".concat(x.VR,"/bonvert/").concat(i),{agent_valid:this.user.CODE_AGENT,description_demande:e.model.description_demande,nom_beneficiaire:e.model.nom_beneficiaire,prenom_beneficiaire:e.model.prenom_beneficiaire,matricule_beneficiaire:e.model.matricule_beneficiaire,fonction_beneficiaire:e.model.fonction_beneficiaire,nom_mandataire:e.model.nom_mandataire,prenom_mandataire:e.model.prenom_mandataire,matricule_mandataire:e.model.matricule_mandataire,fonction_mandataire:e.model.fonction_mandataire,pmotif:e.model.objet_demande,centre_imputation:e.model.centre,activite:e.model.activitee,nature:e.model.nature,montant_bon_vert:e.model.montant_bon_vert,flag_soumis:1,flag_valid:1},function(e){e instanceof k.UA||t.handleCancel()})}else a=Object.assign(Object.assign({},a),{added_user:this.user.id})}},{key:"loadData1",value:function(e){var t=this;console.log(e),setTimeout(function(){t.loading=!0},1e3)}},{key:"handleCancel",value:function(){this.isVisible=!1}},{key:"loadData",value:function(e){var t=this;this.loading=!0;var a=null!=e.globalFilter?"&search=".concat(e.globalFilter):"";setTimeout(function(){t.getDataBvert("".concat(x.VR,"/bonvert/?flag_valid=0&page=").concat(e.first/e.rows+1,"&per_page=").concat(e.rows).concat(a),function(e){if(!(e instanceof k.UA)){var a=e.body.data;a=a.map(function(e){return Object.assign(Object.assign({},e),{objet_demand:null==e?void 0:e.pmotif.lib_motif,nom:(null==e?void 0:e.nom_beneficiaire)+" "+(null==e?void 0:e.prenom_beneficiaire),pagent:(null==e?void 0:e.pagent.nom_agent)+" "+(null==e?void 0:e.pagent.pnom_agent),service:null==e?void 0:e.pagent.code_serv.lib_serv,lib_fonct:null==e?void 0:e.pagent.code_fonct.lib_fonct,status:1==e.flag_valid})}),t.data=a}})},1)}}]),l}(m.K),A.\u0275fac=function(e){return new(e||A)(b.Y36(y.Kf),b.Y36(g.O),b.Y36(_.L),b.Y36(v.dD),b.Y36(h.e),b.Y36(O.h),b.Y36(b.sBO))},A.\u0275cmp=b.Xpm({type:A,selectors:[["checkout-form-validation"]],features:[b.qOj],decls:3,vars:16,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[3,"data","wrapper","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(b.TgZ(0,"nz-modal",0),b.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),b.YNc(1,w,1,4,"wl-form",1),b.qZA(),b.TgZ(2,"wl-table",2),b.NdJ("onLazyLoad",function(e){return t.loadData(e)}),b.qZA()),2&e&&(b.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),b.xp6(2),b.Udp("margin-top","1rem"),b.Q6J("data",t.data)("wrapper","fieldset")("columns",t.columns)("actions",t.actions)("lazy",!0)("caption","CheckoutFormList ")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[p.du,p.Hf,d.a,c.U],styles:[""]}),A),data:{title:"CheckoutFormValidation",breadcrumb:"CheckoutFormValidation"}}],E=function(){var t=a(function t(){e(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.oAB({type:t}),t.\u0275inj=b.cJS({imports:[[f.Bz.forChild(V)],f.Bz]}),t}(),S=l(73500),G=((F=a(function t(){e(this,t)})).\u0275fac=function(e){return new(e||F)},F.\u0275mod=b.oAB({type:F}),F.\u0275inj=b.cJS({imports:[[r.ez,s.u5,s.UX,d.n,c.e,u.j,S.X0,E,p.Qp]]}),F)}}])}();