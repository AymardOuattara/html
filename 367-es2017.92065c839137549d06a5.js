(self.webpackChunkwil_admin_angular=self.webpackChunkwil_admin_angular||[]).push([[367],{69367:function(e,t,i){"use strict";i.r(t),i.d(t,{ReferenceManagementModule:function(){return Z}});var s=i(38583),o=i(3679),a=i(977),n=i(65461),l=i(66782),r=i(98542),d=i(43022),c=i(95987),p=i(99688),u=i(37716),h=i(44212),m=i(18859),g=i(52121),f=i(68058),b=i(4768),T=i(28723);let x=(()=>{class e extends p.K{constructor(e,t,i,s,o,a){super(e,t,i,s,o,a),this.logger=e,this.httpService=t,this.envService=i,this.messageService=s,this.authService=o,this.menuService=a}ngOnInit(){this.isSpinning=!1,this.globalFilterFields=["id"],this.columns=[{field:"id",header:"ID"},{field:"status",header:"STATUS",type:"status"},{field:"created_at",header:"CREATED_AT",type:"date"},{field:"updated_at",header:"UPDATED_AT",type:"date"}],this.actions=[{type:"default",icon:"edit",shape:"circle",loading:!1,click:e=>{this.edit(e),this.form.model=Object.assign({},e)}},{type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Are-you sure ?",loading:!1,click:e=>{this.delete(e,"reference-management")},cancel:e=>{}}]}save(e){this.logger.log("model: ",e.model);let t=Object.assign({},e.model);t=Object.assign(Object.assign({},t),t.id&&null!=t.id?{updated_user:this.user.id}:{added_user:this.user.id})}loadData(e){console.log(e),setTimeout(()=>{this.loading=!0},1e3)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(h.Kf),u.Y36(m.O),u.Y36(g.L),u.Y36(f.dD),u.Y36(b.e),u.Y36(T.h))},e.\u0275cmp=u.Xpm({type:e,selectors:[["reference-management"]],features:[u.qOj],decls:3,vars:18,consts:[["nzTip","Loading...",3,"nzSpinning"],[3,"alert","model","fields","options","onSubmit","onModelChange"],[3,"data","wrapper","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"]],template:function(e,t){1&e&&(u.TgZ(0,"nz-spin",0),u.TgZ(1,"wl-form",1),u.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),u.qZA(),u.qZA(),u.TgZ(2,"wl-table",2),u.NdJ("onLazyLoad",function(e){return t.loadData(e)}),u.qZA()),2&e&&(u.Q6J("nzSpinning",t.isSpinning),u.xp6(1),u.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options),u.xp6(1),u.Udp("margin-top","1rem"),u.Q6J("data",t.data)("wrapper","fieldset")("columns",t.columns)("actions",t.actions)("lazy",!0)("caption","Reference Management ")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[l.W,n.U,a.a],styles:[""]}),e})();var O=i(42394);const v={},y={},A=[{template:"<p>Vous pouvez ajouter des services \xe0 votre organisation.</p>"},{templateOptions:{label:"Formulaire de cr\xe9ation",toggleable:!0},fieldGroup:[{},{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-3 wl-hidden",key:"id",type:"input",templateOptions:{translate:!0,label:"ID",readonly:!0}},{className:"flex-3",key:"name",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Nom",placeholder:"Nom",suffixIcon:"user"}},{className:"flex-3",key:"surname",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Prenoms",placeholder:"Prenoms",suffixIcon:"user"}},{className:"flex-3",key:"matricule",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Matricule",placeholder:"Matricule",suffixIcon:"number"}},{className:"flex-3",key:"service_id",type:"select",templateOptions:{translate:!0,required:!0,translatePlaceholder:!0,label:"Service",placeholder:"Service",suffixIcon:"container",options:[],valueProp:"id",labelProp:"libelle"}},{className:"flex-3",key:"telephone",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Telephone",placeholder:"Telephone",suffixIcon:"phone"}},{className:"flex-3",key:"portable",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Portable",placeholder:"Portable",suffixIcon:"phone"}},{className:"flex-3",key:"email",type:"input-email",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Email",placeholder:"Email",suffixIcon:"mail",pattern:/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/},validation:{messages:{pattern:(e,t)=>`"${t.formControl.value}" n'est pas une adresse email valide`}}},{className:"flex-3",key:"adresse",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Adresse",placeholder:"Adresse",suffixIcon:"number"}},,{className:"flex-3",key:"lieu_naissance",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Lieu de Naissance",placeholder:"Lieu de Naissance",suffixIcon:"aim"}},{className:"flex-6",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:e=>{e.templateOptions.loading=!0,e.form.statusChanges.subscribe(t=>{e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":(e,t,i)=>!i.form.valid}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:e=>{e.options.resetModel(v)}}}]}]}];var S=i(91841);function E(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"wl-form",7),u.NdJ("onSubmit",function(t){return u.CHM(e),u.oxw().save(t)})("onModelChange",function(t){return u.CHM(e),u.oxw().modelChange(t)}),u.qZA()}if(2&e){const e=u.oxw();u.Q6J("alert",e.alert)("model",e.form.model)("fields",e.form.fields)("options",e.form.options)}}const D=i(23815);let C=(()=>{class e extends p.K{constructor(e,t,i,s,o,a,n,l){super(e,t,i,s,o,a,n),this.logger=e,this.httpService=t,this.envService=i,this.messageService=s,this.authService=o,this.menuService=a,this.modal=n,this.changeDetectorRef=l,this.isEditMode=!1,this.isVisible=!1;const r=this.authService.hasPermissionAuthorizationV2(["USER_LIST.CREATE","USER_LIST.LOCK","USER_LIST.EDIT","USER_LIST.UNLOCK","USER_LIST.EXPORT","USER_LIST.DELETE","SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);this.hasPermissionToLock=r[1],this.hasPermissionToEdit=r[2],this.hasPermissionToUnlock=r[3],this.hasPermissionToExport=r[4],this.hasPermissionToDelete=r[5],this.hasPermissionToShowAllEntityData=r[6],this.hasPermissionToShowDataRoot=r[7],this.hasPermissionToCreate=r[0]}maFonction(){this.form.fields[0].template="<p>Veuillez remplir ce formulaire pour cr\xe9er un agent.</p>",this.isVisible=!0,this.isEditMode=!1}get modalTitle(){return this.isEditMode?"Mise \xe0 jour":"Ajouter"}ngAfterViewInit(){}ngOnInit(){this.loadAllService(),this.form.model=Object.assign({},v),this.form.fields=A,this.form.options=y,this.globalFilterFields=["name","surname","matricule","email","adresse"],this.columns=[{field:"service.libelle",header:"Service"},{field:"name",header:"Nom"},{field:"surname",header:"Prenom(s)"},{field:"matricule",header:"Matricule"},{field:"email",header:"Email"},{field:"adresse",header:"Adresse"},{field:"status",header:"Status",type:"status",falseText:"Inactif",trueText:"Actif"},{field:"created_at",header:"Created_at",type:"date"}],this.user&&this.hasPermissionToEdit&&this.actions.push({type:"default",icon:"edit",shape:"circle",loading:!1,click:e=>{this.edit(e),this.logger.log(e),this.isEditMode=!0,this.isVisible=!0,console.log(e),this.form.fields[0].template="<p>Veuillez renseigner ce formulaire pour modifier les informations dudit agent.</p>",setTimeout(()=>{this.alert=void 0,e.status=0!=e.status,this.form.model=Object.assign({},e),this.form.fields[0].fieldGroup[0].template=`<h5>Vous modifiez de l'utilisateur <i>${e.login}</i> </h5>`,this.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="Enregistrer",this.changeDetectorRef.detectChanges()},1)}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"warning",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:e=>{this.swingstatus(e)},cancel:e=>{}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:e=>{this.delete(e,"agent")},cancel:e=>{}})}save(e){if(console.log(e),1==this.isEditMode){this.changeDetectorRef.detectChanges(),this.logger.log("event.model: ",e.model);let t=Object.assign(Object.assign({},e.model),{phone:e.model.prefix+" "+e.model.phone,session:this.user.session_id});this.logger.log("payload ",t);const i=t.id;t=D.omit(t,["id"]),t=Object.assign(Object.assign({},t),{updated_user:this.user.id}),this.putData(`${O.T5}/agent/${i}`,t,e=>{e instanceof S.UA||(this.loadData(this.currentLoadEvent),this.isVisible=!1)})}else{let t=Object.assign(Object.assign({},e.model),{code:e.model.code,libelle:e.model.libelle,session:this.user.session_id});console.log(t),this.logger.log("payload ",t),t.id&&null!=t.id?(t=Object.assign(Object.assign({},t),{added_user:this.user.id}),this.postData(`${O.T5}/agent`,t,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})):(console.log(t),t=D.omit(t,["id"]),t=Object.assign(Object.assign({},t),{added_user:this.user.id}),this.postData(`${O.T5}/agent`,t,e=>{e instanceof S.UA||(this.loadData(this.currentLoadEvent),this.isVisible=!1)}))}}swingstatus(e){const t=e.id,i=e.status;if(1==i){let i=D.omit(e,["id"]);i={status:!1,updated_user:this.user.id},this.putData(`${O.T5}/agent/${t}`,i,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})}if(0==i){let i=D.omit(e,["id"]);i={status:!0,updated_user:this.user.id},this.putData(`${O.T5}/agent/${t}`,i,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})}}loadData(e){this.currentLoadEvent=e;const t=null!=e.globalFilter?`&search={"sKey":"all","sValue":"${e.globalFilter}"}`:"";setTimeout(()=>{this.loading=!0,this.getData(`${O.T5}/agent/?page=${e.first/e.rows+1}&per_page=${e.rows}${t}`)},1)}loadAllService(){const e=(this.authService.hasPermissionAuthorization("SHOW_DATA.ALL_ENTITY"),`${O.T5}/service/`);this.httpService.getData(`${e}`).toPromise().then(e=>{this.isSpinning=!1;let t=e.body.rows;this.notAllPrivilege&&t.push(...this.user.entities),this.form.fields=this.mapFields(this.form.fields,"service_id","templateOptions.options",t)}).catch(e=>{this.logger.error(e)})}handleCancel(){this.isVisible=!1}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(h.Kf),u.Y36(m.O),u.Y36(g.L),u.Y36(f.dD),u.Y36(b.e),u.Y36(T.h),u.Y36(r.Sf),u.Y36(u.sBO))},e.\u0275cmp=u.Xpm({type:e,selectors:[["agent-management"]],features:[u.qOj],decls:11,vars:18,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[2,"width","100%","text-align","center"],[2,"border","3px dashed whitesmoke","padding","400px"],[2,"font-size","small"],[1,"button-19",2,"margin-left","20px",3,"click"],[3,"data","styleClass","showTools","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(u.TgZ(0,"nz-modal",0),u.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),u.YNc(1,E,1,4,"wl-form",1),u.qZA(),u._UZ(2,"br"),u.TgZ(3,"table",2),u.TgZ(4,"tr",3),u.TgZ(5,"td"),u.TgZ(6,"h5",4),u._uU(7," Ajouter un agent \xe0 votre organisation en cliquant sur ce bouton "),u.TgZ(8,"button",5),u.NdJ("click",function(){return t.maFonction()}),u._uU(9,"Ajouter"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(10,"wl-table",6),u.NdJ("onLazyLoad",function(e){return t.loadData(e)}),u.qZA()),2&e&&(u.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),u.xp6(10),u.Udp("margin-top","1rem"),u.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("showTools",t.hasPermissionToExport)("columns",t.columns)("showTools",!0)("actions",t.actions)("lazy",!0)("caption","Departements")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[r.du,r.Hf,a.a,n.U],styles:[".search-input .inline{display:inline-block;margin:0!important;padding:0!important}  .search-input .inline nz-input-group{border-radius:.2rem 0 0 .2rem!important}  .search-input .inline:last-child button{border-radius:0 0 10px 0}  .search-input .inline:last-child{position:relative;top:1.8rem;left:-1.5px;margin:0;padding:0}  .search-input .inline:last-child nz-input-group{border-radius:0 .2rem .2rem 0!important}  .button-19{background:#0d6d3a;border:1px solid #0d6d3a;border-radius:6px;box-shadow:1px 2px 4px rgba(0,0,0,.1);box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:nunito,roboto,proxima-nova,proxima nova,sans-serif;font-size:13px;font-weight:800;line-height:16px;min-height:40px;outline:0;padding:12px 14px;text-align:center;text-rendering:geometricprecision;text-transform:none;-moz-user-select:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle}  .button-19:active,   .button-19:hover{background-color:transparent;background-color:initial;background-position:0 0;color:#0d6d3a}"]}),e})();const w={},z={},_=[{template:"<p>Vous pouvez ajouter des departements \xe0 votre organisation.</p>"},{templateOptions:{label:"Formulaire de cr\xe9ation",toggleable:!0},fieldGroup:[{},{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-3 wl-hidden",key:"id",type:"input",templateOptions:{translate:!0,label:"ID",readonly:!0}},{className:"flex-4",key:"code",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Code",placeholder:"Code",suffixIcon:"number"}},{className:"flex-4",key:"libelle",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Libelle",placeholder:"Libelle",suffixIcon:"container"}},{className:"flex-2",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:e=>{e.templateOptions.loading=!0,e.form.statusChanges.subscribe(t=>{e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":(e,t,i)=>!i.form.valid}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:e=>{e.options.resetModel(w)}}}]}]}];function L(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"wl-form",7),u.NdJ("onSubmit",function(t){return u.CHM(e),u.oxw().save(t)})("onModelChange",function(t){return u.CHM(e),u.oxw().modelChange(t)}),u.qZA()}if(2&e){const e=u.oxw();u.Q6J("alert",e.alert)("model",e.form.model)("fields",e.form.fields)("options",e.form.options)}}const k=i(23815);let P=(()=>{class e extends p.K{constructor(e,t,i,s,o,a,n,l){super(e,t,i,s,o,a,n),this.logger=e,this.httpService=t,this.envService=i,this.messageService=s,this.authService=o,this.menuService=a,this.modal=n,this.changeDetectorRef=l,this.isEditMode=!1,this.isVisible=!1;const r=this.authService.hasPermissionAuthorizationV2(["USER_LIST.CREATE","USER_LIST.LOCK","USER_LIST.EDIT","USER_LIST.UNLOCK","USER_LIST.EXPORT","USER_LIST.DELETE","SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);this.hasPermissionToLock=r[1],this.hasPermissionToEdit=r[2],this.hasPermissionToUnlock=r[3],this.hasPermissionToExport=r[4],this.hasPermissionToDelete=r[5],this.hasPermissionToShowAllEntityData=r[6],this.hasPermissionToShowDataRoot=r[7],this.hasPermissionToCreate=r[0]}maFonction(){this.form.fields[0].template="<p>Veuillez remplir ce formulaire pour cr\xe9er un departement.</p>",this.isVisible=!0,this.isEditMode=!1}get modalTitle(){return this.isEditMode?"Mise \xe0 jour":"Ajouter"}ngAfterViewInit(){}ngOnInit(){this.form.model=Object.assign({},w),this.form.fields=_,this.form.options=z,this.globalFilterFields=["code","libelle","status"],this.columns=[{field:"code",header:"Code"},{field:"libelle",header:"Libelle"},{field:"status",header:"STATUS",type:"status",falseText:"Inactif",trueText:"Actif"},{field:"created_at",header:"CREATED_AT",type:"date"}],this.user&&this.hasPermissionToEdit&&this.actions.push({type:"default",icon:"edit",shape:"circle",loading:!1,click:e=>{this.edit(e),this.logger.log(e),this.isEditMode=!0,this.isVisible=!0,this.form.fields[0].template="<p>Veuillez renseigner ce formulaire pour modifier les informations dudit departement.</p>",setTimeout(()=>{this.alert=void 0,e.status=0!=e.status,this.form.model=Object.assign({},e),this.form.fields[0].fieldGroup[0].template=`<h5>Vous modifiez de l'utilisateur <i>${e.login}</i> </h5>`,this.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="Enregistrer",this.changeDetectorRef.detectChanges()},1)}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"warning",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:e=>{this.swingstatus(e)},cancel:e=>{}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:e=>{this.delete(e,"departments")},cancel:e=>{}})}save(e){if(console.log(e),1==this.isEditMode){this.changeDetectorRef.detectChanges(),this.logger.log("event.model: ",e.model);let t=Object.assign(Object.assign({},e.model),{phone:e.model.prefix+" "+e.model.phone,session:this.user.session_id});this.logger.log("payload ",t);const i=t.id;t=k.omit(t,["id"]),t=Object.assign(Object.assign({},t),{updated_user:this.user.id}),this.putData(`${O.T5}/departments/${i}`,t,e=>{e instanceof S.UA||(this.loadData(this.currentLoadEvent),this.isVisible=!1)})}else{let t=Object.assign(Object.assign({},e.model),{code:e.model.code,libelle:e.model.libelle,session:this.user.session_id});console.log(t),this.logger.log("payload ",t),t.id&&null!=t.id?(t=Object.assign(Object.assign({},t),{added_user:this.user.id}),this.postData(`${O.T5}/departments`,t,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})):(console.log(t),t=k.omit(t,["id"]),t=Object.assign(Object.assign({},t),{added_user:this.user.id}),this.postData(`${O.T5}/departments`,t,e=>{e instanceof S.UA||(this.loadData(this.currentLoadEvent),this.isVisible=!1)}))}}swingstatus(e){const t=e.id,i=e.status;if(1==i){let i=k.omit(e,["id"]);i={status:!1,updated_user:this.user.id},this.putData(`${O.T5}/departments/${t}`,i,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})}if(0==i){let i=k.omit(e,["id"]);i={status:!0,updated_user:this.user.id},this.putData(`${O.T5}/departments/${t}`,i,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})}}loadData(e){this.loading=!0,this.currentLoadEvent=e,this.getData(`${O.T5}/departments/?page=${e.first/e.rows+1}&per_page=${e.rows}${null!=e.globalFilter?`&search={"sKey":"all","sValue":"${e.globalFilter}"}`:""}${e.sortField&&null!=e.sortField?`&sort=[{"sortField":"${e.sortField}","sortOrder":"${1==e.sortOrder?"ASC":"DESC"}"}]`:'&sort=[{"sortField":"id","sortOrder":"DESC"}]'}`,e=>{if(!(e instanceof S.UA)){let t=e.body.rows;this.user&&!this.user.is_root&&(t=t.filter(e=>!e.is_root)),this.hasPermissionToShowDataRoot||(t=t.filter(e=>!e.profiles.map(e=>e.code).includes("PROF_ROOT"))),t=t.map(e=>Object.assign(Object.assign({},e),{trClass:e.status?"Actif":"Inactif"})),this.data=t,this.loading=!1,this.changeDetectorRef.detectChanges()}})}handleCancel(){this.isVisible=!1}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(h.Kf),u.Y36(m.O),u.Y36(g.L),u.Y36(f.dD),u.Y36(b.e),u.Y36(T.h),u.Y36(r.Sf),u.Y36(u.sBO))},e.\u0275cmp=u.Xpm({type:e,selectors:[["list"]],features:[u.qOj],decls:11,vars:18,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[2,"width","100%","text-align","center"],[2,"border","3px dashed whitesmoke","padding","400px"],[2,"font-size","small"],[1,"button-19",2,"margin-left","20px",3,"click"],[3,"data","styleClass","showTools","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(u.TgZ(0,"nz-modal",0),u.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),u.YNc(1,L,1,4,"wl-form",1),u.qZA(),u._UZ(2,"br"),u.TgZ(3,"table",2),u.TgZ(4,"tr",3),u.TgZ(5,"td"),u.TgZ(6,"h5",4),u._uU(7," Ajouter un departement \xe0 votre organisation en cliquant sur ce bouton "),u.TgZ(8,"button",5),u.NdJ("click",function(){return t.maFonction()}),u._uU(9,"Ajouter"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(10,"wl-table",6),u.NdJ("onLazyLoad",function(e){return t.loadData(e)}),u.qZA()),2&e&&(u.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),u.xp6(10),u.Udp("margin-top","1rem"),u.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("showTools",t.hasPermissionToExport)("columns",t.columns)("showTools",!0)("actions",t.actions)("lazy",!0)("caption","Departements")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[r.du,r.Hf,a.a,n.U],styles:[".search-input .inline{display:inline-block;margin:0!important;padding:0!important}  .search-input .inline nz-input-group{border-radius:.2rem 0 0 .2rem!important}  .search-input .inline:last-child button{border-radius:0 0 10px 0}  .search-input .inline:last-child{position:relative;top:1.8rem;left:-1.5px;margin:0;padding:0}  .search-input .inline:last-child nz-input-group{border-radius:0 .2rem .2rem 0!important}  .button-19{background:#0d6d3a;border:1px solid #0d6d3a;border-radius:6px;box-shadow:1px 2px 4px rgba(0,0,0,.1);box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:nunito,roboto,proxima-nova,proxima nova,sans-serif;font-size:13px;font-weight:800;line-height:16px;min-height:40px;outline:0;padding:12px 14px;text-align:center;text-rendering:geometricprecision;text-transform:none;-moz-user-select:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle}  .button-19:active,   .button-19:hover{background-color:transparent;background-color:initial;background-position:0 0;color:#0d6d3a}"],changeDetection:0}),e})();const R={},j={},F=[{template:"<p>Vous pouvez ajouter des services \xe0 votre organisation.</p>"},{templateOptions:{label:"Formulaire de cr\xe9ation",toggleable:!0},fieldGroup:[{},{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-3 wl-hidden",key:"id",type:"input",templateOptions:{translate:!0,label:"ID",readonly:!0}},{className:"flex-3",key:"departement_id",type:"select",templateOptions:{translate:!0,required:!0,translatePlaceholder:!0,label:"Departement",placeholder:"Departement",suffixIcon:"user",options:[],valueProp:"id",labelProp:"libelle"}},{className:"flex-3",key:"code",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Code",placeholder:"Code",suffixIcon:"number"}},{className:"flex-3",key:"libelle",type:"input",templateOptions:{translate:!0,translatePlaceholder:!0,required:!0,label:"Libelle",placeholder:"Libelle",suffixIcon:"container"}},{className:"flex-2",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"Est actif ?"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"Soumettre",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:e=>{e.templateOptions.loading=!0,e.form.statusChanges.subscribe(t=>{e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":(e,t,i)=>!i.form.valid}},{type:"button",templateOptions:{type:"reset",label:"R\xe9initialiser",bgColor:"#000",textColor:"#fff",click:e=>{e.options.resetModel(R)}}}]}]}];function U(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"wl-form",7),u.NdJ("onSubmit",function(t){return u.CHM(e),u.oxw().save(t)})("onModelChange",function(t){return u.CHM(e),u.oxw().modelChange(t)}),u.qZA()}if(2&e){const e=u.oxw();u.Q6J("alert",e.alert)("model",e.form.model)("fields",e.form.fields)("options",e.form.options)}}const V=i(23815),N=[{path:"",component:x,data:{title:"ReferenceManagement",breadcrumb:"ReferenceManagement"}},{path:"reference-management",component:x,data:{title:"ReferenceManagement",breadcrumb:"ReferenceManagement"}},{path:"agent-management",component:C,data:{title:"Agent Management",breadcrumb:"Agent Management"}},{path:"department-management",component:P,data:{title:"Department Management",breadcrumb:"Department Management"}},{path:"service-management",component:(()=>{class e extends p.K{constructor(e,t,i,s,o,a,n,l){super(e,t,i,s,o,a,n),this.logger=e,this.httpService=t,this.envService=i,this.messageService=s,this.authService=o,this.menuService=a,this.modal=n,this.changeDetectorRef=l,this.isEditMode=!1,this.isVisible=!1;const r=this.authService.hasPermissionAuthorizationV2(["USER_LIST.CREATE","USER_LIST.LOCK","USER_LIST.EDIT","USER_LIST.UNLOCK","USER_LIST.EXPORT","USER_LIST.DELETE","SHOW_DATA.ALL_ENTITY","SHOW_DATA.ROOT"]);this.hasPermissionToLock=r[1],this.hasPermissionToEdit=r[2],this.hasPermissionToUnlock=r[3],this.hasPermissionToExport=r[4],this.hasPermissionToDelete=r[5],this.hasPermissionToShowAllEntityData=r[6],this.hasPermissionToShowDataRoot=r[7],this.hasPermissionToCreate=r[0]}maFonction(){this.form.fields[0].template="<p>Veuillez remplir ce formulaire pour cr\xe9er un service.</p>",this.isVisible=!0,this.isEditMode=!1}get modalTitle(){return this.isEditMode?"Mise \xe0 jour":"Ajouter"}ngAfterViewInit(){}ngOnInit(){this.loadAllDepartment(),this.form.model=Object.assign({},R),this.form.fields=F,this.form.options=j,this.globalFilterFields=["code","libelle","status"],this.columns=[{field:"department.libelle",header:"Departement"},{field:"code",header:"Code"},{field:"libelle",header:"Libelle"},{field:"status",header:"STATUS",type:"status",falseText:"Inactif",trueText:"Actif"},{field:"created_at",header:"CREATED_AT",type:"date"}],this.user&&this.hasPermissionToEdit&&this.actions.push({type:"default",icon:"edit",shape:"circle",loading:!1,click:e=>{this.edit(e),this.logger.log(e),this.isEditMode=!0,this.isVisible=!0,console.log(e),this.form.fields[0].template="<p>Veuillez renseigner ce formulaire pour modifier les informations dudit service.</p>",setTimeout(()=>{this.alert=void 0,e.status=0!=e.status,this.form.model=Object.assign({},e),this.form.fields[0].fieldGroup[0].template=`<h5>Vous modifiez de l'utilisateur <i>${e.login}</i> </h5>`,this.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="Enregistrer",this.changeDetectorRef.detectChanges()},1)}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"warning",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:e=>{this.swingstatus(e)},cancel:e=>{}}),this.user&&this.hasPermissionToDelete&&this.actions.push({type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Etes-vous s\xfbre ?",cancelText:"Annuler",okText:"Oui",loading:!1,click:e=>{this.delete(e,"service")},cancel:e=>{}})}save(e){if(console.log(e),1==this.isEditMode){this.changeDetectorRef.detectChanges(),this.logger.log("event.model: ",e.model);let t=Object.assign(Object.assign({},e.model),{phone:e.model.prefix+" "+e.model.phone,session:this.user.session_id});this.logger.log("payload ",t);const i=t.id;t=V.omit(t,["id"]),t=Object.assign(Object.assign({},t),{updated_user:this.user.id}),this.putData(`${O.T5}/service/${i}`,t,e=>{e instanceof S.UA||(this.loadData(this.currentLoadEvent),this.isVisible=!1)})}else{let t=Object.assign(Object.assign({},e.model),{code:e.model.code,libelle:e.model.libelle,session:this.user.session_id});console.log(t),this.logger.log("payload ",t),t.id&&null!=t.id?(t=Object.assign(Object.assign({},t),{added_user:this.user.id}),this.postData(`${O.T5}/service`,t,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})):(console.log(t),t=V.omit(t,["id"]),t=Object.assign(Object.assign({},t),{added_user:this.user.id}),this.postData(`${O.T5}/service`,t,e=>{e instanceof S.UA||(this.loadData(this.currentLoadEvent),this.isVisible=!1)}))}}swingstatus(e){const t=e.id,i=e.status;if(1==i){let i=V.omit(e,["id"]);i={status:!1,updated_user:this.user.id},this.putData(`${O.T5}/service/${t}`,i,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})}if(0==i){let i=V.omit(e,["id"]);i={status:!0,updated_user:this.user.id},this.putData(`${O.T5}/service/${t}`,i,e=>{e instanceof S.UA||this.loadData(this.currentLoadEvent)})}}loadData(e){this.currentLoadEvent=e;const t=null!=e.globalFilter?`&search={"sKey":"all","sValue":"${e.globalFilter}"}`:"";setTimeout(()=>{this.loading=!0,this.getData(`${O.T5}/service/?page=${e.first/e.rows+1}&per_page=${e.rows}${t}`)},1)}loadAllDepartment(){const e=(this.authService.hasPermissionAuthorization("SHOW_DATA.ALL_ENTITY"),`${O.T5}/departments/`);this.httpService.getData(`${e}`).toPromise().then(e=>{this.isSpinning=!1;let t=e.body.rows;this.notAllPrivilege&&t.push(...this.user.entities),this.form.fields=this.mapFields(this.form.fields,"departement_id","templateOptions.options",t)}).catch(e=>{this.logger.error(e)})}handleCancel(){this.isVisible=!1}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(h.Kf),u.Y36(m.O),u.Y36(g.L),u.Y36(f.dD),u.Y36(b.e),u.Y36(T.h),u.Y36(r.Sf),u.Y36(u.sBO))},e.\u0275cmp=u.Xpm({type:e,selectors:[["service-management"]],features:[u.qOj],decls:11,vars:18,consts:[["nzWidth","920px",3,"nzVisible","nzTitle","nzFooter","nzVisibleChange","nzOnCancel"],[3,"alert","model","fields","options","onSubmit","onModelChange",4,"nzModalContent"],[2,"width","100%","text-align","center"],[2,"border","3px dashed whitesmoke","padding","400px"],[2,"font-size","small"],[1,"button-19",2,"margin-left","20px",3,"click"],[3,"data","styleClass","showTools","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"],[3,"alert","model","fields","options","onSubmit","onModelChange"]],template:function(e,t){1&e&&(u.TgZ(0,"nz-modal",0),u.NdJ("nzVisibleChange",function(e){return t.isVisible=e})("nzOnCancel",function(){return t.handleCancel()}),u.YNc(1,U,1,4,"wl-form",1),u.qZA(),u._UZ(2,"br"),u.TgZ(3,"table",2),u.TgZ(4,"tr",3),u.TgZ(5,"td"),u.TgZ(6,"h5",4),u._uU(7," Ajouter un service \xe0 votre organisation en cliquant sur ce bouton "),u.TgZ(8,"button",5),u.NdJ("click",function(){return t.maFonction()}),u._uU(9,"Ajouter"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(10,"wl-table",6),u.NdJ("onLazyLoad",function(e){return t.loadData(e)}),u.qZA()),2&e&&(u.Q6J("nzVisible",t.isVisible)("nzTitle",t.modalTitle)("nzFooter",null),u.xp6(10),u.Udp("margin-top","1rem"),u.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("showTools",t.hasPermissionToExport)("columns",t.columns)("showTools",!0)("actions",t.actions)("lazy",!0)("caption","Departements")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[r.du,r.Hf,a.a,n.U],styles:[".search-input .inline{display:inline-block;margin:0!important;padding:0!important}  .search-input .inline nz-input-group{border-radius:.2rem 0 0 .2rem!important}  .search-input .inline:last-child button{border-radius:0 0 10px 0}  .search-input .inline:last-child{position:relative;top:1.8rem;left:-1.5px;margin:0;padding:0}  .search-input .inline:last-child nz-input-group{border-radius:0 .2rem .2rem 0!important}  .button-19{background:#0d6d3a;border:1px solid #0d6d3a;border-radius:6px;box-shadow:1px 2px 4px rgba(0,0,0,.1);box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:nunito,roboto,proxima-nova,proxima nova,sans-serif;font-size:13px;font-weight:800;line-height:16px;min-height:40px;outline:0;padding:12px 14px;text-align:center;text-rendering:geometricprecision;text-transform:none;-moz-user-select:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;vertical-align:middle}  .button-19:active,   .button-19:hover{background-color:transparent;background-color:initial;background-position:0 0;color:#0d6d3a}"]}),e})(),data:{title:"Service Management",breadcrumb:"Service Management"}}];let M=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[c.Bz.forChild(N)],c.Bz]}),e})(),Z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.ez,o.u5,o.UX,a.n,r.Qp,n.e,l.j,M,d.q6]]}),e})()}}]);