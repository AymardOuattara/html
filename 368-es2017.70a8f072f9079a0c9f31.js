(self.webpackChunkwil_admin_angular=self.webpackChunkwil_admin_angular||[]).push([[368],{17368:function(e,t,l){"use strict";l.r(t),l.d(t,{RegionalModule:function(){return E}});var a=l(38583),o=l(95987),s=l(42394),i=l(37716),n=l(18859);let r=(()=>{class e{constructor(e){this.httpService=e}resolve(e){const t=e.paramMap.get("lang_code");return this.httpService.getData(s.T5+"/langs/byCode/"+t).toPromise().then(e=>{console.log("resolver lang =>",e);const t=e.body.data;return t?t.label:"unknow"})}}return e.\u0275fac=function(t){return new(t||e)(i.LFG(n.O))},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=l(99688);const p={},c={},u=[{wrappers:["fieldset-wrapper"],templateOptions:{label:"Formulaire de cr\xe9ation",toggleable:!0},fieldGroup:[{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-auto wl-hidden",key:"id",type:"input",templateOptions:{hidden:!0,translate:!0,label:"FORM_LABEL.ID",readonly:!0}},{className:"flex-auto",key:"code",type:"input",templateOptions:{required:!0,translate:!0,label:"FORM_LABEL.CODE"}},{className:"flex-auto",key:"label",type:"input",templateOptions:{translate:!0,required:!0,label:"FORM_LABEL.LABEL"}},{className:"flex-auto",key:"flag",type:"input",templateOptions:{translate:!0,label:"FORM_LABEL.FLAG"}},{className:"flex-2",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"FORM_LABEL.IS_ACTIVE"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"FORM_LABEL.SUBMIT",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:e=>{console.log("clik on submit"),e.templateOptions.loading=!0,e.form.statusChanges.subscribe(t=>{e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":(e,t,l)=>!l.form.valid}},{type:"button",templateOptions:{type:"reset",label:"Reset",bgColor:"#000",textColor:"#fff",click:e=>{e.options.resetModel(p)}}}]}]}];var m=l(44212),f=l(52121),g=l(68058),h=l(4768),b=l(28723),y=l(65461),O=l(977);let L=(()=>{class e extends d.K{constructor(e,t,l,a,o,s,i){super(e,t,l,a,o,s),this.logger=e,this.httpService=t,this.envService=l,this.messageService=a,this.authService=o,this.menuService=s,this.router=i}ngOnInit(){this.form.options=c,this.form.model=p,this.form.fields=u,this.isSpinning=!1,this.globalFilterFields=["key","value"],this.columns=[{field:"code",header:"CODE"},{field:"label",header:"LABEL"},{field:"flag",header:"FLAG"},{field:"status",header:"STATUS",type:"status"}],this.actions=[{type:"default",icon:"edit",shape:"circle",loading:!1,click:e=>{this.edit(e),this.form.model=Object.assign({},e),this.form.fields[0].fieldGroup[1].fieldGroup[0].templateOptions.label="SAVE"}},{type:"default",title:"Add a translation",icon:"translation",shape:"circle",loading:!1,click:e=>{this.router.navigate(["/private/settings/regional/translation",e.code])}},{type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Are-you sure ?",loading:!1,click:e=>{this.delete(e,"langs",!1)},cancel:e=>{}}]}save(e){this.logger.log("model: ",e.model);let t=Object.assign(Object.assign({},e.model),{added_user:this.user.id});if(t.id&&null!=t.id){const e=t.id;s._.omit(t,["id"]),this.putData(`${s.T5}/langs/${e}`,t)}else t=s._.omit(t,["id"]),this.postData(`${s.T5}/langs`,t)}loadData(e){setTimeout(()=>{this.loading=!0,this.getData(`${s.T5}/langs/?page=${e.first/e.rows+1}&per_page=${e.rows}`)},1)}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(m.Kf),i.Y36(n.O),i.Y36(f.L),i.Y36(g.dD),i.Y36(h.e),i.Y36(b.h),i.Y36(o.F0))},e.\u0275cmp=i.Xpm({type:e,selectors:[["lang"]],features:[i.qOj],decls:2,vars:18,consts:[[3,"alert","model","fields","options","onSubmit","onModelChange"],[3,"data","styleClass","wrapper","columns","actions","lazy","caption","paginator","rows","totalRecords","loading","globalFilterFields","onLazyLoad"]],template:function(e,t){1&e&&(i.TgZ(0,"wl-form",0),i.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),i.qZA(),i.TgZ(1,"wl-table",1),i.NdJ("onLazyLoad",function(e){return t.loadData(e)}),i.qZA()),2&e&&(i.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options),i.xp6(1),i.Udp("margin-top","1rem"),i.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("wrapper","fieldset")("columns",t.columns)("actions",t.actions)("lazy",!0)("caption","General Settings")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("globalFilterFields",t.globalFilterFields))},directives:[y.U,O.a],styles:[""]}),e})();const _={},A={},v=[{wrappers:["fieldset-wrapper"],templateOptions:{label:"Formulaire de cr\xe9ation",toggleable:!0},fieldGroup:[{wrappers:["accordion-wrapper"],fieldGroup:[{templateOptions:{label:"Create Form",toggleable:!0},fieldGroup:[{fieldGroupClassName:"d-flex flex-wrap",fieldGroup:[{className:"flex-auto",key:"id",type:"input",hide:!0,templateOptions:{hidden:!0,translate:!0,label:"FORM_LABEL.ID",readonly:!0}},{className:"flex-auto",key:"lang_code",type:"select",templateOptions:{required:!0,translate:!0,url:s.T5+"/langs/load",valueProp:"code",labelProp:"label",label:"FORM_LABEL.LANG_CODE"}},{className:"flex-auto",key:"key",type:"input",templateOptions:{translate:!0,required:!0,label:"FORM_LABEL.KEY"}},{className:"flex-auto",key:"value",type:"input",templateOptions:{translate:!0,required:!0,label:"FORM_LABEL.VALUE"}},{className:"flex-2",key:"status",type:"checkbox",templateOptions:{translate:!0,label:"FORM_LABEL.IS_ACTIVE"},defaultValue:!0}]},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"FORM_LABEL.SUBMIT",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:e=>{console.log("clik on submit"),e.templateOptions.loading=!0,e.form.statusChanges.subscribe(t=>{e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":"!model.lang_code || !model.key || !model.value"}},{type:"button",templateOptions:{type:"reset",label:"Reset",bgColor:"#000",textColor:"#fff",click:e=>{e.options.resetModel(e=>console.log(e))}}}]}]},{templateOptions:{label:"Create from file",toggleable:!0},fieldGroupClassName:"d-flex flex-wrap flex-start",fieldGroup:[{className:"flex-2",key:"lang_code",type:"select",templateOptions:{required:!0,translate:!0,url:s.T5+"/langs/load",valueProp:"code",labelProp:"label",label:"FORM_LABEL.LANG_CODE"}},{className:"flex-8",key:"file_line",type:"file-upload",templateOptions:{accept:"application/json",fileType:"application/json",translate:!0,label:"FORM_LABEL.FILE",handleUpload:(e,t)=>{const l=t[0],a=new FileReader;function o(t,l){return Object.keys(t).map(a=>"object"==typeof t[a]?o(t[a],a):{key:l?l+"."+a:a,value:t[a],lang_code:e.model.lang_code,status:!0})}a.readAsText(l,"UTF-8"),a.onload=function(t){const l=JSON.parse(t.target.result);console.log(l),s._.mapKeys(l,function(e,t){return{key:t,value:e}});const a=s._.flattenDeep(o(l));console.log(a),e.formControl.setValue(a),e.options.formState.enableSubmitBtn=!0},a.onerror=e=>{console.log(e)}}}},{fieldGroupClassName:"action-bloc",fieldGroup:[{className:"flex-1",type:"button",templateOptions:{type:"submit",label:"FORM_LABEL.SUBMIT",translate:!0,loading:!1,disabled:!0,colorType:"primary",click:e=>{console.log("clik on submit"),e.templateOptions.loading=!0,e.form.statusChanges.subscribe(t=>{e.templateOptions.loading&&(e.templateOptions.loading=!1)})}},expressionProperties:{"templateOptions.disabled":(e,t,l)=>!t.enableSubmitBtn}}]}]}]}]}];var w=l(91841);let k=(()=>{class e extends d.K{constructor(e,t,l,a,o,s,i){super(e,t,l,a,o,s),this.logger=e,this.httpService=t,this.envService=l,this.messageService=a,this.authService=o,this.menuService=s,this.route=i,this.lang_code="en",this.lang_code=this.route.snapshot.paramMap.get("lang_code")}ngOnInit(){this.form.options=A,this.form.model=_,this.form.model.lang_code=this.lang_code,this.form.fields=v,this.isSpinning=!1,this.columns=[{field:"lang.label",header:"LANG"},{field:"key",header:"KEY"},{field:"value",header:"VALUE"},{field:"status",header:"STATUS",type:"status"}],this.globalFilterFields=["key","value"],this.actions=[{type:"default",icon:"edit",shape:"circle",loading:!1,click:e=>{this.edit(e),this.form.model=Object.assign({},e),this.form.fields[0].fieldGroup[0].fieldGroup[0].fieldGroup[1].fieldGroup[0].templateOptions.label="SAVE"}},{type:"default",icon:"delete",shape:"circle",popConfirm:!0,popTitle:"Are-you sure ?",loading:!1,click:e=>{this.delete(e,"translations",!1)},cancel:e=>{}}],this.groupActions={class:"",actions:[{type:"default",class:"p-button-danger",icon:"pi pi-trash",title:"Delete",click:e=>{const t=e.map(e=>e.id).join(",");this.logger.log(t),this.deleteV2({callback:e=>{e&&this.deleteData(`${s.T5}/translations/${t}`,e=>{this.reloadData(e)})}})}}]}}save(e){this.logger.log("model: ",e.model);let t=Object.assign({},e.model);if(t.id&&null!=t.id){const l=t.id;t=Object.assign(Object.assign({},e.model),{updated_user:this.user.id}),t=s._.omit(t,["id"]),this.putData(`${s.T5}/translations/${l}`,t)}else{if(t=s._.omit(t,["id"]),t=Object.assign(Object.assign({},t),{added_user:this.user.id}),t.file_line&&null!=t.file_line)return t.file_line=t.file_line.map(e=>Object.assign(Object.assign({},e),{added_user:this.user.id})),this.postData(`${s.T5}/translations`,t.file_line,e=>{this.form.options.resetModel(),this.reloadData(e)});this.postData(`${s.T5}/translations`,t),this.form.options.formState.enableSubmitBtn=!1}}loadData(e){this.logger.log("loadData event: ",e);const t=null!=e.globalFilter?`&search={"sKey":"all","sValue":"${e.globalFilter}"}`:this.lang_code?`&search={"lang_code":"${this.lang_code}"}`:"";setTimeout(()=>{this.loading=!0,this.getData(`${s.T5}/translations/?page=${e.first/e.rows+1}&per_page=${e.rows}${t}`)},1)}onRowSelect(e){}reloadData(e){e instanceof w.UA||this.loadData({first:0,rows:this.rows})}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(m.Kf),i.Y36(n.O),i.Y36(f.L),i.Y36(g.dD),i.Y36(h.e),i.Y36(b.h),i.Y36(o.gz))},e.\u0275cmp=i.Xpm({type:e,selectors:[["translation"]],features:[i.qOj],decls:2,vars:21,consts:[[3,"alert","model","fields","options","onSubmit","onModelChange"],[3,"data","styleClass","wrapper","columns","actions","groupActions","lazy","caption","paginator","rows","totalRecords","loading","selectionMode","globalFilterFields","selectedData","onLazyLoad","onRowSelect"]],template:function(e,t){1&e&&(i.TgZ(0,"wl-form",0),i.NdJ("onSubmit",function(e){return t.save(e)})("onModelChange",function(e){return t.modelChange(e)}),i.qZA(),i.TgZ(1,"wl-table",1),i.NdJ("onLazyLoad",function(e){return t.loadData(e)})("onRowSelect",function(e){return t.onRowSelect(e)}),i.qZA()),2&e&&(i.Q6J("alert",t.alert)("model",t.form.model)("fields",t.form.fields)("options",t.form.options),i.xp6(1),i.Udp("margin-top","1rem"),i.Q6J("data",t.data)("styleClass","p-datatable-gridlines p-datatable-sm")("wrapper","fieldset")("columns",t.columns)("actions",t.actions)("groupActions",t.groupActions)("lazy",!0)("caption","Translation")("paginator",!0)("rows",t.rows)("totalRecords",t.totalRecords)("loading",t.loading)("selectionMode","multiple")("globalFilterFields",t.globalFilterFields)("selectedData",t.tableSelectedData))},directives:[y.U,O.a],styles:[""]}),e})();const F=[{path:"lang",component:L,data:{title:"MENU_LABEL.Lang",breadcrumb:"MENU_LABEL.Lang"}},{path:"translation",data:{title:"MENU_LABEL.Translation",breadcrumb:"MENU_LABEL.Translation"},children:[{path:"",component:k},{path:":lang_code",component:k,resolve:{title:r,breadcrumb:r}}]}];let S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[o.Bz.forChild(F)],o.Bz]}),e})();var C=l(97234);let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({providers:[n.O,r,{provide:w.TP,useClass:C.s,multi:!0}],imports:[[a.ez,S,y.e,O.n]]}),e})()}}]);